<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>E-Commerce ERD Â· Mahabubur Rahman (DD)</title>
<link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;500;600&family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   THEME VARIABLES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
[data-theme="dark"] {
  --bg:       #060b14;  --surface:  #0a1120;  --card:    #0d1626;
  --card-h:   #111d35;  --border:   #1a2a45;  --border-h:#2a4070;
  --text:     #cdd9f0;  --text2:    #7a95b8;  --muted:   #3d5578;
  --panel-bg: #08101e;  --inp-bg:   #0f1a2e;
  --shadow:   rgba(0,0,0,0.6);
}
[data-theme="light"] {
  --bg:       #f0f4f8;  --surface:  #e2e8f0;  --card:    #ffffff;
  --card-h:   #f8faff;  --border:   #cbd5e1;  --border-h:#94a3b8;
  --text:     #0f172a;  --text2:    #334155;  --muted:   #94a3b8;
  --panel-bg: #f8faff;  --inp-bg:   #ffffff;
  --shadow:   rgba(0,0,0,0.15);
}
:root {
  --s1:#22d3ee; --s2:#818cf8; --s3:#34d399; --s4:#f97316;
  --s5:#f472b6; --s6:#fbbf24; --s7:#fb7185; --s8:#2dd4bf;
  --s9:#a78bfa; --s10:#64748b;
  --mono:'Fira Code',monospace; --sans:'Plus Jakarta Sans',sans-serif;
}
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;}
body{background:var(--bg);color:var(--text);font-family:var(--sans);min-height:100vh;overflow:hidden;transition:background .3s,color .3s;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BG CANVAS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#bgCanvas{position:fixed;inset:0;pointer-events:none;z-index:0;opacity:.35;transition:opacity .3s;}
[data-theme="light"] #bgCanvas{opacity:.12;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LAYOUT SHELL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.shell{display:flex;flex-direction:column;height:100vh;position:relative;z-index:1;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HEADER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.hdr{
  display:flex;align-items:center;gap:1rem;flex-wrap:wrap;
  padding:.9rem 1.5rem;
  border-bottom:1px solid var(--border);
  background:var(--surface);
  flex-shrink:0;
  animation:fadeDown .5s both;
}
@keyframes fadeDown{from{opacity:0;transform:translateY(-16px)}to{opacity:1;transform:translateY(0)}}

.brand{display:flex;align-items:center;gap:.75rem;}
.brand-ico{
  width:38px;height:38px;border-radius:10px;flex-shrink:0;
  background:linear-gradient(135deg,var(--s1),var(--s2));
  display:flex;align-items:center;justify-content:center;font-size:1.1rem;
  box-shadow:0 0 18px rgba(34,211,238,.35);
  animation:glow 3s ease-in-out infinite;
}
@keyframes glow{0%,100%{box-shadow:0 0 18px rgba(34,211,238,.35)}50%{box-shadow:0 0 32px rgba(34,211,238,.65),0 0 55px rgba(129,140,248,.2)}}
.brand-txt h1{font-size:clamp(.9rem,2vw,1.25rem);font-weight:800;letter-spacing:-.03em;
  background:linear-gradient(120deg,var(--text) 0%,var(--s1) 60%,var(--s2) 100%);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}
.brand-txt p{font-family:var(--mono);font-size:.55rem;color:var(--muted);letter-spacing:.12em;text-transform:uppercase;margin-top:.15rem;}

/* search */
.search-wrap{display:flex;align-items:center;gap:.5rem;margin-left:auto;}
.search-box{
  display:flex;align-items:center;gap:.5rem;
  background:var(--inp-bg);border:1px solid var(--border);border-radius:8px;
  padding:.38rem .75rem;transition:all .25s;width:260px;
  position: relative;
}
.search-box:focus-within{border-color:var(--s1);box-shadow:0 0 0 3px rgba(34,211,238,.12), 0 0 15px rgba(34,211,238,.15);}
.search-box input{background:none;border:none;outline:none;color:var(--text);font-family:var(--mono);font-size:.7rem;width:100%;}
.search-box input::placeholder{color:var(--muted);}
.search-ico{color:var(--muted);font-size:.85rem;flex-shrink:0;transition:color .25s;}
.search-box:focus-within .search-ico{color:var(--s1);}
#searchCount {
  position: absolute;
  right: 8px;
  font-family: var(--mono);
  font-size: 0.6rem;
  color: var(--muted);
  opacity: 0.8;
  transition: all 0.25s;
  pointer-events: none;
}

/* hdr right buttons */
.hdr-btns{display:flex;gap:.4rem;align-items:center;}
.hbtn{
  display:flex;align-items:center;gap:.35rem;
  font-size:.68rem;font-weight:600;padding:.35rem .7rem;
  background:var(--card);border:1px solid var(--border);border-radius:7px;
  color:var(--text2);cursor:pointer;transition:all .2s;white-space:nowrap;
  font-family:var(--sans);
}
.hbtn:hover{border-color:var(--s1);color:var(--s1);}
.hbtn.active{background:rgba(34,211,238,.1);border-color:var(--s1);color:var(--s1);}

/* stats chips */
.chips{display:flex;gap:.35rem;flex-wrap:wrap;}
.chip{font-family:var(--mono);font-size:.58rem;padding:.22rem .6rem;
  background:rgba(255,255,255,.04);border:1px solid var(--border);border-radius:100px;color:var(--muted);}
.chip strong{color:var(--text);}
[data-theme="light"] .chip{background:rgba(0,0,0,.04);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LEGEND BAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.legend{
  display:flex;align-items:center;gap:.35rem;flex-wrap:wrap;
  padding:.55rem 1.5rem;border-bottom:1px solid var(--border);
  background:var(--surface);flex-shrink:0;
  animation:fadeDown .5s .1s both;
}
.leg-lbl{font-family:var(--mono);font-size:.55rem;color:var(--muted);letter-spacing:.1em;text-transform:uppercase;margin-right:.3rem;}
.ltag{
  display:flex;align-items:center;gap:.3rem;font-size:.65rem;font-weight:700;
  padding:.2rem .55rem;border-radius:5px;border:1px solid transparent;
  cursor:pointer;transition:all .2s;user-select:none;
}
.ltag:hover{transform:translateY(-1px);}
.ltag.hidden{opacity:.35;text-decoration:line-through;}
.ltag .dot{width:6px;height:6px;border-radius:50%;flex-shrink:0;}
.lt1 {color:var(--s1); border-color:rgba(34,211,238,.25); background:rgba(34,211,238,.07);}
.lt2 {color:var(--s2); border-color:rgba(129,140,248,.25);background:rgba(129,140,248,.07);}
.lt3 {color:var(--s3); border-color:rgba(52,211,153,.25); background:rgba(52,211,153,.07);}
.lt4 {color:var(--s4); border-color:rgba(249,115,22,.25); background:rgba(249,115,22,.07);}
.lt5 {color:var(--s5); border-color:rgba(244,114,182,.25);background:rgba(244,114,182,.07);}
.lt6 {color:var(--s6); border-color:rgba(251,191,36,.25); background:rgba(251,191,36,.07);}
.lt7 {color:var(--s7); border-color:rgba(251,113,133,.25);background:rgba(251,113,133,.07);}
.lt8 {color:var(--s8); border-color:rgba(45,212,191,.25); background:rgba(45,212,191,.07);}
.lt9 {color:var(--s9); border-color:rgba(167,139,250,.25);background:rgba(167,139,250,.07);}
.lt10{color:var(--s10);border-color:rgba(100,116,139,.25);background:rgba(100,116,139,.07);}
.leg-key{margin-left:auto;display:flex;gap:.65rem;align-items:center;font-family:var(--mono);font-size:.56rem;color:var(--muted);}
.kb{font-size:.44rem;font-weight:700;padding:.08rem .28rem;border-radius:3px;font-family:var(--mono);}
.kpk{background:rgba(212,170,64,.18);color:#d4aa40;}
.kfk{background:rgba(104,114,200,.18);color:#6872c8;}
.kuk{background:rgba(61,158,119,.18);color:#3d9e77;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MAIN BODY = CANVAS + SIDE PANEL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.main-body{display:flex;flex:1;overflow:hidden;position:relative;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CANVAS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.cWrap{flex:1;overflow:auto;cursor:grab;user-select:none;position:relative;}
.cWrap:active{cursor:grabbing;}
.canvas{position:relative;width:3400px;height:2620px;transform-origin:0 0;}
.canvas::before{
  content:'';position:absolute;inset:0;
  background-image:linear-gradient(rgba(34,211,238,.018) 1px,transparent 1px),
                   linear-gradient(90deg,rgba(34,211,238,.018) 1px,transparent 1px);
  background-size:60px 60px;pointer-events:none;
}
[data-theme="light"] .canvas::before{
  background-image:linear-gradient(rgba(34,211,238,.06) 1px,transparent 1px),
                   linear-gradient(90deg,rgba(34,211,238,.06) 1px,transparent 1px);
}
#svgLines{position:absolute;inset:0;width:100%;height:100%;pointer-events:none;overflow:visible;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ENTITY CARDS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.e{
  position:absolute;background:var(--card);border:1px solid var(--border);
  border-radius:10px;min-width:188px;overflow:hidden;
  box-shadow:0 4px 20px var(--shadow);
  transition:box-shadow .25s,border-color .25s,transform .22s,opacity .3s;
  cursor:pointer;animation:cardIn .55s cubic-bezier(.16,1,.3,1) both;
}
@keyframes cardIn{from{opacity:0;transform:translateY(10px) scale(.97)}to{opacity:1;transform:translateY(0) scale(1)}}
@keyframes searchGlow{
  0%, 100% { 
    box-shadow: 0 4px 20px var(--shadow), 0 0 20px rgba(34,211,238,0.3);
    border-color: rgba(34,211,238,0.4);
    transform: translateY(0) scale(1);
  }
  50% { 
    box-shadow: 0 8px 35px var(--shadow), 0 0 35px rgba(34,211,238,0.6), 0 0 50px rgba(34,211,238,0.3);
    border-color: rgba(34,211,238,0.8);
    transform: translateY(-2px) scale(1.02);
  }
}
.e:hover{transform:translateY(-3px) scale(1.008);z-index:800;}
.e.dimmed{opacity:.08;pointer-events:none;transform:scale(0.95);}
.e.focused{z-index:900;}
.e.search-match{
  border-color: rgba(34,211,238,0.6) !important;
  background: linear-gradient(145deg, var(--card), rgba(34,211,238,0.03));
}
.e.section-hidden{display:none;}

/* top accent + hover glow */
.e.s1 {border-top:2.5px solid var(--s1);}  .e.s1:hover,.e.s1.focused {box-shadow:0 10px 35px var(--shadow),0 0 18px rgba(34,211,238,.25);border-color:rgba(34,211,238,.5);}
.e.s2 {border-top:2.5px solid var(--s2);}  .e.s2:hover,.e.s2.focused {box-shadow:0 10px 35px var(--shadow),0 0 18px rgba(129,140,248,.25);}
.e.s3 {border-top:2.5px solid var(--s3);}  .e.s3:hover,.e.s3.focused {box-shadow:0 10px 35px var(--shadow),0 0 18px rgba(52,211,153,.25);}
.e.s4 {border-top:2.5px solid var(--s4);}  .e.s4:hover,.e.s4.focused {box-shadow:0 10px 35px var(--shadow),0 0 18px rgba(249,115,22,.25);}
.e.s5 {border-top:2.5px solid var(--s5);}  .e.s5:hover,.e.s5.focused {box-shadow:0 10px 35px var(--shadow),0 0 18px rgba(244,114,182,.25);}
.e.s6 {border-top:2.5px solid var(--s6);}  .e.s6:hover,.e.s6.focused {box-shadow:0 10px 35px var(--shadow),0 0 18px rgba(251,191,36,.25);}
.e.s7 {border-top:2.5px solid var(--s7);}  .e.s7:hover,.e.s7.focused {box-shadow:0 10px 35px var(--shadow),0 0 18px rgba(251,113,133,.25);}
.e.s8 {border-top:2.5px solid var(--s8);}  .e.s8:hover,.e.s8.focused {box-shadow:0 10px 35px var(--shadow),0 0 18px rgba(45,212,191,.25);}
.e.s9 {border-top:2.5px solid var(--s9);}  .e.s9:hover,.e.s9.focused {box-shadow:0 10px 35px var(--shadow),0 0 18px rgba(167,139,250,.25);}
.e.s10{border-top:2.5px solid var(--s10);} .e.s10:hover,.e.s10.focused{box-shadow:0 10px 35px var(--shadow),0 0 18px rgba(100,116,139,.25);}

/* card header */
.eh{display:flex;align-items:center;gap:.4rem;padding:.48rem .75rem;
  border-bottom:1px solid var(--border);font-size:.68rem;font-weight:700;letter-spacing:.03em;
  position:relative;}
.s1 .eh{color:var(--s1);background:rgba(34,211,238,.06);}
.s2 .eh{color:var(--s2);background:rgba(129,140,248,.06);}
.s3 .eh{color:var(--s3);background:rgba(52,211,153,.06);}
.s4 .eh{color:var(--s4);background:rgba(249,115,22,.06);}
.s5 .eh{color:var(--s5);background:rgba(244,114,182,.06);}
.s6 .eh{color:var(--s6);background:rgba(251,191,36,.06);}
.s7 .eh{color:var(--s7);background:rgba(251,113,133,.06);}
.s8 .eh{color:var(--s8);background:rgba(45,212,191,.06);}
.s9 .eh{color:var(--s9);background:rgba(167,139,250,.06);}
.s10 .eh{color:var(--s10);background:rgba(100,116,139,.06);}
.edot{width:6px;height:6px;border-radius:50%;flex-shrink:0;}
.eico{font-size:.82rem;}

/* SQL copy button */
.copy-sql{
  margin-left:auto;font-size:.52rem;font-family:var(--mono);
  background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.1);
  color:inherit;border-radius:4px;padding:.12rem .4rem;cursor:pointer;
  opacity:0;transition:opacity .2s,background .2s;white-space:nowrap;
}
.e:hover .copy-sql{opacity:1;}
.copy-sql:hover{background:rgba(255,255,255,.15);}
.copy-sql.copied{background:rgba(52,211,153,.2);border-color:var(--s3);color:var(--s3);}

/* fields */
.ef{padding:.42rem .75rem .48rem;display:flex;flex-direction:column;gap:.14rem;}
.f{display:flex;align-items:center;gap:.32rem;font-family:var(--mono);
  font-size:.565rem;line-height:1.5;color:var(--text2);padding:.06rem 0;
  border-radius:3px;transition:color .15s,background .15s;}
.f:hover{color:var(--text);background:rgba(255,255,255,.025);padding-left:3px;}
[data-theme="light"] .f{color:#475569;}
[data-theme="light"] .f:hover{color:#0f172a;background:rgba(0,0,0,.04);}
.f.pk{color:#d4aa40;font-weight:600;} .f.fk{color:#6872c8;} .f.uk{color:#3d9e77;}
[data-theme="light"] .f.pk{color:#92701a;} [data-theme="light"] .f.fk{color:#4338ca;} [data-theme="light"] .f.uk{color:#166534;}
.f.pk:hover{color:#f0c848;} .f.fk:hover{color:#818cf8;} .f.uk:hover{color:#34d399;}
.fb{font-size:.44rem;font-weight:700;padding:.07rem .26rem;border-radius:3px;letter-spacing:.06em;flex-shrink:0;font-family:var(--mono);}
.bpk{background:rgba(212,170,64,.18);color:#d4aa40;} .bfk{background:rgba(104,114,200,.18);color:#6872c8;} .buk{background:rgba(61,158,119,.18);color:#3d9e77;}
.f-sep{height:1px;background:var(--border);margin:.12rem 0;opacity:.6;}

/* section labels */
.slbl{position:absolute;font-family:var(--mono);font-size:.52rem;letter-spacing:.18em;text-transform:uppercase;opacity:.2;pointer-events:none;font-weight:600;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SIDE PANEL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.side-panel{
  width:0;overflow:hidden;background:var(--panel-bg);
  border-left:1px solid var(--border);
  transition:width .3s cubic-bezier(.16,1,.3,1);
  display:flex;flex-direction:column;flex-shrink:0;
}
.side-panel.open{width:320px;}

.sp-header{
  display:flex;align-items:center;justify-content:space-between;
  padding:.85rem 1rem .7rem;border-bottom:1px solid var(--border);flex-shrink:0;
}
.sp-title{font-size:.8rem;font-weight:700;display:flex;align-items:center;gap:.5rem;}
.sp-close{background:none;border:none;color:var(--muted);cursor:pointer;font-size:1rem;
  transition:color .2s;width:24px;height:24px;display:flex;align-items:center;justify-content:center;border-radius:5px;}
.sp-close:hover{color:var(--text);background:var(--border);}

.sp-body{flex:1;overflow-y:auto;padding:1rem;}
.sp-body::-webkit-scrollbar{width:4px;} .sp-body::-webkit-scrollbar-thumb{background:var(--border);border-radius:4px;}

.sp-section{margin-bottom:1.2rem;}
.sp-section h3{font-size:.65rem;font-family:var(--mono);letter-spacing:.12em;text-transform:uppercase;color:var(--muted);margin-bottom:.6rem;}

.sp-col{
  display:flex;align-items:center;justify-content:space-between;
  padding:.35rem .5rem;border-radius:6px;margin-bottom:.2rem;
  background:var(--card);border:1px solid var(--border);
  font-family:var(--mono);font-size:.62rem;
  transition:background .2s;
}
.sp-col:hover{background:var(--card-h);}
.sp-col .col-name{font-weight:600;color:var(--text);}
.sp-col .col-type{color:var(--muted);font-size:.56rem;}
.sp-col .col-badge{font-size:.44rem;font-weight:700;padding:.07rem .28rem;border-radius:3px;}

.sp-rel{
  display:flex;align-items:center;gap:.5rem;
  padding:.32rem .5rem;border-radius:6px;margin-bottom:.2rem;
  background:var(--card);border:1px solid var(--border);
  font-family:var(--mono);font-size:.6rem;
  cursor:pointer;transition:all .2s;
}
.sp-rel:hover{border-color:var(--s1);color:var(--s1);}
.sp-rel .rel-arrow{opacity:.5;}

.sp-sql-btn{
  width:100%;padding:.55rem;border-radius:8px;
  background:linear-gradient(135deg,rgba(34,211,238,.12),rgba(129,140,248,.12));
  border:1px solid rgba(34,211,238,.25);color:var(--s1);
  font-family:var(--mono);font-size:.65rem;font-weight:600;
  cursor:pointer;transition:all .25s;letter-spacing:.04em;
  display:flex;align-items:center;justify-content:center;gap:.5rem;
}
.sp-sql-btn:hover{background:linear-gradient(135deg,rgba(34,211,238,.22),rgba(129,140,248,.22));transform:translateY(-1px);}
.sp-sql-btn.copied{background:rgba(52,211,153,.15);border-color:var(--s3);color:var(--s3);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MINI-MAP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.minimap{
  position:fixed;bottom:56px;right:1.2rem;z-index:500;
  width:240px;height:160px;
  background:linear-gradient(135deg, var(--surface), rgba(34,211,238,0.03));
  border:2px solid rgba(34,211,238,0.25);
  border-radius:12px;overflow:hidden;
  box-shadow:0 15px 40px var(--shadow), 0 0 20px rgba(34,211,238,0.1);
  transition:all .35s cubic-bezier(.16,1,.3,1);
  backdrop-filter:blur(15px);-webkit-backdrop-filter:blur(15px);
}
.minimap:hover {
  transform: translateY(-3px) scale(1.02);
  border-color: rgba(34,211,238,0.4);
  box-shadow: 0 20px 50px var(--shadow), 0 0 30px rgba(34,211,238,0.2);
}
.minimap.hidden{opacity:0;pointer-events:none;transform:translateY(20px) scale(0.9);}
.minimap-canvas{width:100%;height:100%;}
.minimap-viewport{
  position:absolute;border:2px solid rgba(34,211,238,.8);
  background:rgba(34,211,238,.12);border-radius:3px;
  pointer-events:none;transition:all .1s;
  box-shadow: 0 0 10px rgba(34,211,238,0.4), inset 0 0 5px rgba(34,211,238,0.2);
}
.minimap-label{
  position:absolute;top:8px;left:10px;
  font-family:var(--mono);font-size:.55rem;color:rgba(34,211,238,.9);
  letter-spacing:.08em;font-weight:700;
  text-shadow: 0 0 8px rgba(34,211,238,0.5);
  text-transform: uppercase;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ZOOM CONTROLS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.zoom-ctrl{
  position:fixed;bottom:56px;left:1.2rem;z-index:500;
  display:flex;flex-direction:column;gap:.35rem;
}
.zcb{
  width:34px;height:34px;background:var(--card);border:1px solid var(--border);
  border-radius:8px;color:var(--text);font-size:.95rem;cursor:pointer;
  display:flex;align-items:center;justify-content:center;
  transition:all .2s;font-family:var(--mono);
}
.zcb:hover{background:var(--card-h);border-color:var(--s1);color:var(--s1);box-shadow:0 0 10px rgba(34,211,238,.2);transform:scale(1.1);}
.zoom-val{font-family:var(--mono);font-size:.58rem;color:var(--muted);text-align:center;padding:.18rem .3rem;background:var(--card);border:1px solid var(--border);border-radius:6px;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOOLTIP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.tip{
  position:fixed;background:var(--card-h);border:1px solid var(--border-h);
  border-radius:7px;padding:.4rem .75rem;font-family:var(--mono);font-size:.62rem;
  color:var(--text);pointer-events:none;z-index:9999;display:none;white-space:nowrap;
  box-shadow:0 6px 20px var(--shadow);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FOOTER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.footer{
  position:fixed;bottom:0;left:0;right:0;z-index:999;height:44px;
  background:var(--surface);border-top:1px solid var(--border);
  display:flex;align-items:center;justify-content:space-between;
  padding:0 1.5rem;backdrop-filter:blur(20px);
  animation:fadeUp .5s .3s both;
}
@keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
.f-left{display:flex;align-items:center;gap:.65rem;}
.f-av{
  width:26px;height:26px;border-radius:7px;flex-shrink:0;
  background:linear-gradient(135deg,var(--s1),var(--s5));
  display:flex;align-items:center;justify-content:center;
  font-size:.68rem;font-weight:800;color:#fff;font-family:var(--mono);
  box-shadow:0 0 10px rgba(34,211,238,.3);
}
.f-name{font-size:.73rem;font-weight:700;}
.f-name span{background:linear-gradient(90deg,var(--s1),var(--s5));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}
.f-role{font-family:var(--mono);font-size:.55rem;color:var(--muted);}
.f-right{display:flex;align-items:center;gap:.5rem;font-family:var(--mono);font-size:.56rem;color:var(--muted);}
.ftag{display:flex;align-items:center;gap:.3rem;padding:.18rem .5rem;background:rgba(255,255,255,.03);border:1px solid var(--border);border-radius:4px;}
[data-theme="light"] .ftag{background:rgba(0,0,0,.04);}
</style>
</head>
<body>
<canvas id="bgCanvas"></canvas>

<div class="shell">
<!-- â•â• HEADER â•â• -->
<div class="hdr">
  <div class="brand">
    <div class="brand-ico">â¬¡</div>
    <div class="brand-txt">
      <h1>Multi-Vendor E-commerce Platform
Â· ERD</h1>
      <p>MySQL 8.2+ Â· InnoDB Â· utf8mb4 Â· 65 Tables</p>
    </div>
  </div>

  <div class="chips">
    <div class="chip"><strong>65</strong> Tables</div>
    <div class="chip"><strong>10</strong> Domains</div>
    <div class="chip"><strong>3</strong> Views</div>
    <div class="chip"><strong>5</strong> Triggers</div>
  </div>

  <div class="search-wrap">
    <div class="search-box">
      <span class="search-ico">ğŸ”</span>
      <input type="text" id="searchIn" placeholder="Search table..." autocomplete="off">
    </div>
  </div>

  <div class="hdr-btns">
    <button class="hbtn" id="btnMinimap" title="Toggle Mini-Map">ğŸ—ºï¸ Map</button>
    <button class="hbtn" id="btnTheme" title="Toggle Theme">ğŸŒ— Theme</button>
    <button class="hbtn" id="btnReset" title="Reset View">âŒ‚ Reset</button>
    <button class="hbtn" id="btnEsc" title="Clear Focus" style="display:none">âœ• Clear</button>
  </div>
</div>

<!-- â•â• LEGEND â•â• -->
<div class="legend">
  <span class="leg-lbl">Toggle â†’</span>
  <div class="ltag lt1"  data-sec="s1"  onclick="toggleSection('s1',this)"> <div class="dot" style="background:var(--s1)"></div>01 User&Auth</div>
  <div class="ltag lt2"  data-sec="s2"  onclick="toggleSection('s2',this)"> <div class="dot" style="background:var(--s2)"></div>02 Products</div>
  <div class="ltag lt3"  data-sec="s3"  onclick="toggleSection('s3',this)"> <div class="dot" style="background:var(--s3)"></div>03 Orders</div>
  <div class="ltag lt4"  data-sec="s4"  onclick="toggleSection('s4',this)"> <div class="dot" style="background:var(--s4)"></div>04 Inventory</div>
  <div class="ltag lt5"  data-sec="s5"  onclick="toggleSection('s5',this)"> <div class="dot" style="background:var(--s5)"></div>05 Vendors</div>
  <div class="ltag lt6"  data-sec="s6"  onclick="toggleSection('s6',this)"> <div class="dot" style="background:var(--s6)"></div>06 Shipping</div>
  <div class="ltag lt7"  data-sec="s7"  onclick="toggleSection('s7',this)"> <div class="dot" style="background:var(--s7)"></div>07 Reviews</div>
  <div class="ltag lt8"  data-sec="s8"  onclick="toggleSection('s8',this)"> <div class="dot" style="background:var(--s8)"></div>08 Marketing</div>
  <div class="ltag lt9"  data-sec="s9"  onclick="toggleSection('s9',this)"> <div class="dot" style="background:var(--s9)"></div>09 Content</div>
  <div class="ltag lt10" data-sec="s10" onclick="toggleSection('s10',this)"><div class="dot" style="background:var(--s10)"></div>10 System</div>
  <div class="leg-key">
    <span><span class="kb kpk">PK</span> Primary</span>
    <span><span class="kb kfk">FK</span> Foreign</span>
    <span><span class="kb kuk">UK</span> Unique</span>
    <span style="color:var(--muted)">Click legend to hide Â· Click card to focus Â· Click copy for SQL</span>
  </div>
</div>

<!-- â•â• MAIN BODY â•â• -->
<div class="main-body">
  <div class="cWrap" id="cWrap">
    <div class="canvas" id="canvas">
      <svg id="svgLines"></svg>

<!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     ALL ENTITY CARDS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->

<!-- S1: USER & AUTH -->
<div class="slbl" style="left:30px;top:30px;color:var(--s1)">01 Â· User &amp; Authentication</div>

<div class="e s1" id="users" style="left:310px;top:65px;min-width:208px;animation-delay:.04s">
  <div class="eh"><div class="edot" style="background:var(--s1)"></div><span class="eico">ğŸ‘¤</span>users<button class="copy-sql" onclick="copySql(event,'users')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT UNSIGNED</div>
    <div class="f uk"><span class="fb buk">UK</span>email VARCHAR(255)</div>
    <div class="f">email_verified_at TIMESTAMP</div>
    <div class="f">password VARCHAR(255)</div>
    <div class="f">first_name / last_name VARCHAR</div>
    <div class="f">phone VARCHAR(20)</div>
    <div class="f">avatar / date_of_birth</div>
    <div class="f">gender ENUM</div>
    <div class="f-sep"></div>
    <div class="f">user_type ENUM (customer/vendor/admin)</div>
    <div class="f">status ENUM (active/suspended/banned)</div>
    <div class="f">two_factor_enabled BOOLEAN</div>
    <div class="f">two_factor_secret VARCHAR</div>
    <div class="f-sep"></div>
    <div class="f">last_login_at TIMESTAMP</div>
    <div class="f">last_login_ip VARCHAR(45)</div>
    <div class="f">failed_login_attempts INT</div>
    <div class="f">locked_until TIMESTAMP</div>
    <div class="f-sep"></div>
    <div class="f">preferred_language / currency</div>
    <div class="f">timezone VARCHAR(50)</div>
    <div class="f">created_at / updated_at</div>
    <div class="f">deleted_at TIMESTAMP (soft delete)</div>
  </div>
</div>

<div class="e s1" id="user_roles" style="left:35px;top:65px;animation-delay:.07s">
  <div class="eh"><div class="edot" style="background:var(--s1)"></div><span class="eico">ğŸ”‘</span>user_roles<button class="copy-sql" onclick="copySql(event,'user_roles')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>user_id â†’ users.id</div>
    <div class="f fk"><span class="fb bfk">FK</span>role_id â†’ roles.id</div>
    <div class="f">created_at TIMESTAMP</div>
    <div class="f uk"><span class="fb buk">UK</span>UNIQUE(user_id, role_id)</div>
  </div>
</div>

<div class="e s1" id="roles" style="left:35px;top:255px;animation-delay:.09s">
  <div class="eh"><div class="edot" style="background:var(--s1)"></div><span class="eico">ğŸ­</span>roles<button class="copy-sql" onclick="copySql(event,'roles')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f uk"><span class="fb buk">UK</span>name VARCHAR(50)</div>
    <div class="f">display_name VARCHAR(100)</div>
    <div class="f">description TEXT</div>
    <div class="f">created_at / updated_at</div>
  </div>
</div>

<div class="e s1" id="role_permissions" style="left:35px;top:420px;animation-delay:.11s">
  <div class="eh"><div class="edot" style="background:var(--s1)"></div><span class="eico">ğŸ›¡ï¸</span>role_permissions<button class="copy-sql" onclick="copySql(event,'role_permissions')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>role_id â†’ roles.id</div>
    <div class="f fk"><span class="fb bfk">FK</span>permission_id â†’ permissions.id</div>
    <div class="f">created_at TIMESTAMP</div>
  </div>
</div>

<div class="e s1" id="permissions" style="left:35px;top:567px;animation-delay:.13s">
  <div class="eh"><div class="edot" style="background:var(--s1)"></div><span class="eico">âœ…</span>permissions<button class="copy-sql" onclick="copySql(event,'permissions')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f uk"><span class="fb buk">UK</span>name VARCHAR(100)</div>
    <div class="f">display_name VARCHAR(150)</div>
    <div class="f">module VARCHAR(50)</div>
    <div class="f">description TEXT</div>
  </div>
</div>

<div class="e s1" id="user_addresses" style="left:590px;top:65px;animation-delay:.15s">
  <div class="eh"><div class="edot" style="background:var(--s1)"></div><span class="eico">ğŸ“</span>user_addresses<button class="copy-sql" onclick="copySql(event,'user_addresses')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>user_id â†’ users.id</div>
    <div class="f">address_type ENUM (shipping/billing/both)</div>
    <div class="f">full_name VARCHAR(150)</div>
    <div class="f">phone VARCHAR(20)</div>
    <div class="f">address_line1 / address_line2</div>
    <div class="f">city / state / postal_code</div>
    <div class="f">country / country_code CHAR(2)</div>
    <div class="f">is_default BOOLEAN</div>
  </div>
</div>

<div class="e s1" id="user_sessions" style="left:590px;top:305px;animation-delay:.17s">
  <div class="eh"><div class="edot" style="background:var(--s1)"></div><span class="eico">ğŸ’»</span>user_sessions<button class="copy-sql" onclick="copySql(event,'user_sessions')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>user_id â†’ users.id</div>
    <div class="f uk"><span class="fb buk">UK</span>session_token VARCHAR(255)</div>
    <div class="f">ip_address VARCHAR(45)</div>
    <div class="f">user_agent TEXT</div>
    <div class="f">device_type / browser / os</div>
    <div class="f">last_activity TIMESTAMP</div>
    <div class="f">expires_at TIMESTAMP</div>
  </div>
</div>

<div class="e s1" id="password_resets" style="left:590px;top:520px;animation-delay:.19s">
  <div class="eh"><div class="edot" style="background:var(--s1)"></div><span class="eico">ğŸ”</span>password_resets<button class="copy-sql" onclick="copySql(event,'password_resets')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f">email VARCHAR(255)</div>
    <div class="f">token VARCHAR(255)</div>
    <div class="f">created_at TIMESTAMP</div>
    <div class="f">expires_at TIMESTAMP</div>
  </div>
</div>

<!-- S2: PRODUCTS -->
<div class="slbl" style="left:865px;top:30px;color:var(--s2)">02 Â· Products &amp; Catalog</div>

<div class="e s2" id="categories" style="left:875px;top:65px;animation-delay:.21s">
  <div class="eh"><div class="edot" style="background:var(--s2)"></div><span class="eico">ğŸ“‚</span>categories<button class="copy-sql" onclick="copySql(event,'categories')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>parent_id â†’ categories.id (self)</div>
    <div class="f uk"><span class="fb buk">UK</span>slug VARCHAR(150)</div>
    <div class="f">name VARCHAR(150)</div>
    <div class="f">description TEXT</div>
    <div class="f">icon / image_url VARCHAR</div>
    <div class="f">display_order INT DEFAULT 0</div>
    <div class="f">is_active BOOLEAN DEFAULT TRUE</div>
    <div class="f">product_count INT (denormalized)</div>
    <div class="f">meta_title / meta_description</div>
  </div>
</div>

<div class="e s2" id="category_attributes" style="left:875px;top:340px;animation-delay:.23s">
  <div class="eh"><div class="edot" style="background:var(--s2)"></div><span class="eico">ğŸ”—</span>category_attributes<button class="copy-sql" onclick="copySql(event,'category_attributes')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>category_id</div>
    <div class="f fk"><span class="fb bfk">FK</span>attribute_id</div>
    <div class="f">is_required BOOLEAN</div>
    <div class="f">display_order INT</div>
    <div class="f uk"><span class="fb buk">UK</span>UNIQUE(category_id, attribute_id)</div>
  </div>
</div>

<div class="e s2" id="attributes" style="left:1115px;top:340px;animation-delay:.25s">
  <div class="eh"><div class="edot" style="background:var(--s2)"></div><span class="eico">âš™ï¸</span>attributes<button class="copy-sql" onclick="copySql(event,'attributes')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f uk"><span class="fb buk">UK</span>slug VARCHAR(100)</div>
    <div class="f">name VARCHAR(100)</div>
    <div class="f">type ENUM (text/dropdown/color/radio)</div>
    <div class="f">display_order INT</div>
    <div class="f">is_global / is_visible BOOLEAN</div>
    <div class="f">is_filterable / is_required BOOLEAN</div>
  </div>
</div>

<div class="e s2" id="attribute_values" style="left:1115px;top:535px;animation-delay:.27s">
  <div class="eh"><div class="edot" style="background:var(--s2)"></div><span class="eico">ğŸ¨</span>attribute_values<button class="copy-sql" onclick="copySql(event,'attribute_values')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>attribute_id</div>
    <div class="f">value VARCHAR(200)</div>
    <div class="f">display_value VARCHAR(200)</div>
    <div class="f">color_code VARCHAR(7)</div>
    <div class="f">display_order INT</div>
  </div>
</div>

<div class="e s2" id="products" style="left:1115px;top:65px;min-width:212px;animation-delay:.29s">
  <div class="eh"><div class="edot" style="background:var(--s2)"></div><span class="eico">ğŸ“¦</span>products<button class="copy-sql" onclick="copySql(event,'products')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>vendor_id â†’ vendors.id</div>
    <div class="f fk"><span class="fb bfk">FK</span>category_id â†’ categories.id</div>
    <div class="f uk"><span class="fb buk">UK</span>sku VARCHAR(100)</div>
    <div class="f">name / slug / barcode</div>
    <div class="f">short_description / description</div>
    <div class="f-sep"></div>
    <div class="f">price DECIMAL(10,2)</div>
    <div class="f">sale_price / cost_price</div>
    <div class="f">sale_start_date / sale_end_date</div>
    <div class="f-sep"></div>
    <div class="f">stock_quantity INT</div>
    <div class="f">low_stock_threshold INT</div>
    <div class="f">track_inventory / allow_backorders</div>
    <div class="f-sep"></div>
    <div class="f">weight / length / width / height</div>
    <div class="f">requires_shipping / shipping_class</div>
    <div class="f">tax_class VARCHAR(50)</div>
    <div class="f-sep"></div>
    <div class="f">type ENUM (simple/variable/digital)</div>
    <div class="f">status ENUM (draft/pending/published)</div>
    <div class="f">visibility ENUM</div>
    <div class="f">is_featured / allow_reviews</div>
    <div class="f-sep"></div>
    <div class="f">rating_average DECIMAL(3,2)</div>
    <div class="f">rating_count / view_count / sale_count</div>
    <div class="f">published_at / deleted_at</div>
  </div>
</div>

<div class="e s2" id="product_images" style="left:1390px;top:65px;animation-delay:.31s">
  <div class="eh"><div class="edot" style="background:var(--s2)"></div><span class="eico">ğŸ–¼ï¸</span>product_images<button class="copy-sql" onclick="copySql(event,'product_images')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>product_id</div>
    <div class="f">image_url VARCHAR(255)</div>
    <div class="f">thumbnail_url VARCHAR(255)</div>
    <div class="f">alt_text VARCHAR(255)</div>
    <div class="f">is_primary BOOLEAN</div>
    <div class="f">display_order INT</div>
  </div>
</div>

<div class="e s2" id="product_variants" style="left:1390px;top:290px;animation-delay:.33s">
  <div class="eh"><div class="edot" style="background:var(--s2)"></div><span class="eico">ğŸ”€</span>product_variants<button class="copy-sql" onclick="copySql(event,'product_variants')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>product_id</div>
    <div class="f uk"><span class="fb buk">UK</span>sku VARCHAR(100)</div>
    <div class="f">variant_name VARCHAR(255)</div>
    <div class="f">price / sale_price DECIMAL</div>
    <div class="f">stock_quantity INT</div>
    <div class="f">weight DECIMAL / image_url</div>
    <div class="f">is_active BOOLEAN</div>
  </div>
</div>

<div class="e s2" id="product_variant_attributes" style="left:1390px;top:520px;animation-delay:.35s">
  <div class="eh"><div class="edot" style="background:var(--s2)"></div><span class="eico">ğŸ·ï¸</span>product_variant_attr<button class="copy-sql" onclick="copySql(event,'product_variant_attributes')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>variant_id â†’ product_variants.id</div>
    <div class="f fk"><span class="fb bfk">FK</span>attribute_id â†’ attributes.id</div>
    <div class="f fk"><span class="fb bfk">FK</span>attribute_value_id</div>
    <div class="f uk"><span class="fb buk">UK</span>UNIQUE(variant_id, attribute_id)</div>
  </div>
</div>

<div class="e s2" id="product_attributes" style="left:1390px;top:695px;animation-delay:.37s">
  <div class="eh"><div class="edot" style="background:var(--s2)"></div><span class="eico">ğŸ“‹</span>product_attributes<button class="copy-sql" onclick="copySql(event,'product_attributes')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>product_id</div>
    <div class="f fk"><span class="fb bfk">FK</span>attribute_id</div>
    <div class="f fk"><span class="fb bfk">FK</span>attribute_value_id</div>
    <div class="f">custom_value TEXT</div>
  </div>
</div>

<!-- S3: ORDERS -->
<div class="slbl" style="left:1690px;top:30px;color:var(--s3)">03 Â· Orders &amp; Transactions</div>

<div class="e s3" id="orders" style="left:1700px;top:65px;min-width:212px;animation-delay:.39s">
  <div class="eh"><div class="edot" style="background:var(--s3)"></div><span class="eico">ğŸ›’</span>orders<button class="copy-sql" onclick="copySql(event,'orders')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f uk"><span class="fb buk">UK</span>order_number VARCHAR(50)</div>
    <div class="f fk"><span class="fb bfk">FK</span>user_id (NULL = guest checkout)</div>
    <div class="f">guest_email VARCHAR(255)</div>
    <div class="f fk"><span class="fb bfk">FK</span>shipping_address_id</div>
    <div class="f fk"><span class="fb bfk">FK</span>billing_address_id</div>
    <div class="f-sep"></div>
    <div class="f">subtotal / discount_amount</div>
    <div class="f">shipping_amount / tax_amount</div>
    <div class="f">total_amount DECIMAL(15,2)</div>
    <div class="f">currency VARCHAR(3)</div>
    <div class="f">coupon_code / coupon_discount</div>
    <div class="f-sep"></div>
    <div class="f">status ENUM (8 states)</div>
    <div class="f">payment_status ENUM (5 states)</div>
    <div class="f">fulfillment_status ENUM</div>
    <div class="f">payment_method / gateway</div>
    <div class="f">transaction_id VARCHAR(255)</div>
    <div class="f-sep"></div>
    <div class="f">paid_at / shipped_at</div>
    <div class="f">delivered_at / cancelled_at</div>
  </div>
</div>

<div class="e s3" id="order_addresses" style="left:1680px;top:490px;animation-delay:.41s">
  <div class="eh"><div class="edot" style="background:var(--s3)"></div><span class="eico">ğŸ“®</span>order_addresses<button class="copy-sql" onclick="copySql(event,'order_addresses')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f">full_name VARCHAR(150)</div>
    <div class="f">email VARCHAR(255)</div>
    <div class="f">phone VARCHAR(20)</div>
    <div class="f">address_line1 / address_line2</div>
    <div class="f">city / state / postal_code</div>
    <div class="f">country / country_code CHAR(2)</div>
  </div>
</div>

<div class="e s3" id="order_items" style="left:1980px;top:65px;min-width:208px;animation-delay:.43s">
  <div class="eh"><div class="edot" style="background:var(--s3)"></div><span class="eico">ğŸ§¾</span>order_items<button class="copy-sql" onclick="copySql(event,'order_items')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>order_id â†’ orders.id</div>
    <div class="f fk"><span class="fb bfk">FK</span>product_id (NULL if deleted)</div>
    <div class="f fk"><span class="fb bfk">FK</span>variant_id</div>
    <div class="f fk"><span class="fb bfk">FK</span>vendor_id â†’ vendors.id</div>
    <div class="f-sep"></div>
    <div class="f">product_name / product_sku (snapshot)</div>
    <div class="f">variant_name VARCHAR</div>
    <div class="f">unit_price DECIMAL(10,2)</div>
    <div class="f">quantity INT UNSIGNED</div>
    <div class="f">subtotal / discount / tax / total</div>
    <div class="f-sep"></div>
    <div class="f">commission_rate DECIMAL(5,2)</div>
    <div class="f">commission_amount DECIMAL</div>
    <div class="f">vendor_earnings DECIMAL</div>
    <div class="f">product_image_url VARCHAR</div>
    <div class="f">product_attributes JSON</div>
  </div>
</div>

<div class="e s3" id="order_status_history" style="left:1980px;top:415px;animation-delay:.45s">
  <div class="eh"><div class="edot" style="background:var(--s3)"></div><span class="eico">ğŸ“Š</span>order_status_history<button class="copy-sql" onclick="copySql(event,'order_status_history')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>order_id</div>
    <div class="f">old_status / new_status VARCHAR</div>
    <div class="f">comment TEXT</div>
    <div class="f fk"><span class="fb bfk">FK</span>changed_by â†’ users.id</div>
    <div class="f">created_at TIMESTAMP</div>
  </div>
</div>

<div class="e s3" id="order_notes" style="left:1980px;top:600px;animation-delay:.47s">
  <div class="eh"><div class="edot" style="background:var(--s3)"></div><span class="eico">ğŸ“</span>order_notes<button class="copy-sql" onclick="copySql(event,'order_notes')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>order_id</div>
    <div class="f">note TEXT NOT NULL</div>
    <div class="f">is_customer_note BOOLEAN</div>
    <div class="f fk"><span class="fb bfk">FK</span>created_by â†’ users.id</div>
  </div>
</div>

<div class="e s3" id="refunds" style="left:1680px;top:720px;animation-delay:.49s">
  <div class="eh"><div class="edot" style="background:var(--s3)"></div><span class="eico">ğŸ’¸</span>refunds<button class="copy-sql" onclick="copySql(event,'refunds')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>order_id</div>
    <div class="f uk"><span class="fb buk">UK</span>refund_number VARCHAR(50)</div>
    <div class="f">refund_amount DECIMAL(15,2)</div>
    <div class="f">reason ENUM (6 reasons)</div>
    <div class="f">reason_details TEXT</div>
    <div class="f">status ENUM / refund_method ENUM</div>
    <div class="f fk"><span class="fb bfk">FK</span>processed_by â†’ users.id</div>
    <div class="f">processed_at / transaction_id</div>
  </div>
</div>

<div class="e s3" id="refund_items" style="left:1980px;top:790px;animation-delay:.51s">
  <div class="eh"><div class="edot" style="background:var(--s3)"></div><span class="eico">ğŸ“‹</span>refund_items<button class="copy-sql" onclick="copySql(event,'refund_items')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>refund_id â†’ refunds.id</div>
    <div class="f fk"><span class="fb bfk">FK</span>order_item_id â†’ order_items.id</div>
    <div class="f">quantity INT UNSIGNED</div>
    <div class="f">refund_amount DECIMAL(15,2)</div>
  </div>
</div>

<div class="e s3" id="transactions_t" style="left:1680px;top:990px;animation-delay:.53s">
  <div class="eh"><div class="edot" style="background:var(--s3)"></div><span class="eico">ğŸ’³</span>transactions<button class="copy-sql" onclick="copySql(event,'transactions')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>order_id â†’ orders.id</div>
    <div class="f uk"><span class="fb buk">UK</span>transaction_id VARCHAR(255)</div>
    <div class="f">type ENUM (payment/refund/chargeback)</div>
    <div class="f">amount DECIMAL / currency VARCHAR</div>
    <div class="f">payment_gateway VARCHAR(50)</div>
    <div class="f">gateway_response JSON</div>
    <div class="f">status ENUM / error_code</div>
    <div class="f">processed_at TIMESTAMP</div>
  </div>
</div>

<div class="e s3" id="abandoned_carts" style="left:1980px;top:1010px;animation-delay:.55s">
  <div class="eh"><div class="edot" style="background:var(--s3)"></div><span class="eico">ğŸ›ï¸</span>abandoned_carts<button class="copy-sql" onclick="copySql(event,'abandoned_carts')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>user_id (NULL=guest)</div>
    <div class="f">session_id / email VARCHAR</div>
    <div class="f">cart_data JSON</div>
    <div class="f">total_amount DECIMAL</div>
    <div class="f">recovered BOOLEAN</div>
    <div class="f fk"><span class="fb bfk">FK</span>recovered_order_id</div>
    <div class="f">reminder_sent_count INT</div>
  </div>
</div>

<div class="e s3" id="wishlists" style="left:1680px;top:1205px;animation-delay:.57s">
  <div class="eh"><div class="edot" style="background:var(--s3)"></div><span class="eico">â¤ï¸</span>wishlists<button class="copy-sql" onclick="copySql(event,'wishlists')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>user_id â†’ users.id</div>
    <div class="f fk"><span class="fb bfk">FK</span>product_id â†’ products.id</div>
    <div class="f fk"><span class="fb bfk">FK</span>variant_id â†’ product_variants.id</div>
    <div class="f uk"><span class="fb buk">UK</span>UNIQUE(user_id, product_id, variant_id)</div>
    <div class="f">added_at TIMESTAMP</div>
  </div>
</div>

<!-- S4: INVENTORY -->
<div class="slbl" style="left:865px;top:850px;color:var(--s4)">04 Â· Inventory &amp; Stock</div>

<div class="e s4" id="inventory_logs" style="left:875px;top:890px;animation-delay:.59s">
  <div class="eh"><div class="edot" style="background:var(--s4)"></div><span class="eico">ğŸ“ˆ</span>inventory_logs<button class="copy-sql" onclick="copySql(event,'inventory_logs')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>product_id</div>
    <div class="f fk"><span class="fb bfk">FK</span>variant_id</div>
    <div class="f">type ENUM (purchase/sale/return/damage/adjustment)</div>
    <div class="f">quantity_before INT</div>
    <div class="f">quantity_change INT (Â±)</div>
    <div class="f">quantity_after INT</div>
    <div class="f">reference_type / reference_id</div>
    <div class="f">notes TEXT</div>
    <div class="f fk"><span class="fb bfk">FK</span>created_by â†’ users.id</div>
  </div>
</div>

<div class="e s4" id="stock_alerts" style="left:1115px;top:890px;animation-delay:.61s">
  <div class="eh"><div class="edot" style="background:var(--s4)"></div><span class="eico">ğŸ””</span>stock_alerts<button class="copy-sql" onclick="copySql(event,'stock_alerts')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>product_id</div>
    <div class="f fk"><span class="fb bfk">FK</span>variant_id</div>
    <div class="f">alert_type ENUM (low/out/overstock)</div>
    <div class="f">current_quantity INT</div>
    <div class="f">threshold_quantity INT</div>
    <div class="f">is_resolved BOOLEAN</div>
    <div class="f">resolved_at TIMESTAMP</div>
  </div>
</div>

<div class="e s4" id="warehouses" style="left:875px;top:1125px;animation-delay:.63s">
  <div class="eh"><div class="edot" style="background:var(--s4)"></div><span class="eico">ğŸ­</span>warehouses<button class="copy-sql" onclick="copySql(event,'warehouses')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>vendor_id â†’ vendors.id</div>
    <div class="f uk"><span class="fb buk">UK</span>code VARCHAR(50)</div>
    <div class="f">name VARCHAR(200)</div>
    <div class="f">address / city / state / country</div>
    <div class="f">contact_person / phone / email</div>
    <div class="f">is_active / is_primary BOOLEAN</div>
  </div>
</div>

<div class="e s4" id="warehouse_inventory" style="left:1115px;top:1125px;animation-delay:.65s">
  <div class="eh"><div class="edot" style="background:var(--s4)"></div><span class="eico">ğŸ“¦</span>warehouse_inventory<button class="copy-sql" onclick="copySql(event,'warehouse_inventory')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>warehouse_id</div>
    <div class="f fk"><span class="fb bfk">FK</span>product_id</div>
    <div class="f fk"><span class="fb bfk">FK</span>variant_id</div>
    <div class="f">quantity INT DEFAULT 0</div>
    <div class="f">reserved_quantity INT</div>
    <div class="f">available_quantity (GENERATED)</div>
    <div class="f uk"><span class="fb buk">UK</span>UNIQUE(warehouse, product, variant)</div>
  </div>
</div>

<div class="e s4" id="inventory_reservations" style="left:875px;top:1375px;animation-delay:.67s">
  <div class="eh"><div class="edot" style="background:var(--s4)"></div><span class="eico">ğŸ”’</span>inventory_reservations<button class="copy-sql" onclick="copySql(event,'inventory_reservations')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>order_id</div>
    <div class="f fk"><span class="fb bfk">FK</span>order_item_id</div>
    <div class="f fk"><span class="fb bfk">FK</span>product_id</div>
    <div class="f fk"><span class="fb bfk">FK</span>variant_id</div>
    <div class="f">quantity INT</div>
    <div class="f">status ENUM (reserved/released/fulfilled)</div>
    <div class="f">expires_at / released_at</div>
  </div>
</div>

<div class="e s4" id="stock_transfers" style="left:1115px;top:1375px;animation-delay:.69s">
  <div class="eh"><div class="edot" style="background:var(--s4)"></div><span class="eico">â†”ï¸</span>stock_transfers<button class="copy-sql" onclick="copySql(event,'stock_transfers')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f uk"><span class="fb buk">UK</span>transfer_number VARCHAR</div>
    <div class="f fk"><span class="fb bfk">FK</span>from_warehouse_id</div>
    <div class="f fk"><span class="fb bfk">FK</span>to_warehouse_id</div>
    <div class="f fk"><span class="fb bfk">FK</span>product_id / variant_id</div>
    <div class="f">quantity INT</div>
    <div class="f">status ENUM</div>
    <div class="f fk"><span class="fb bfk">FK</span>transferred_by / received_by</div>
  </div>
</div>

<!-- S5: VENDORS -->
<div class="slbl" style="left:30px;top:850px;color:var(--s5)">05 Â· Vendors &amp; Payments</div>

<div class="e s5" id="vendors" style="left:35px;top:890px;min-width:212px;animation-delay:.71s">
  <div class="eh"><div class="edot" style="background:var(--s5)"></div><span class="eico">ğŸª</span>vendors<button class="copy-sql" onclick="copySql(event,'vendors')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>user_id â†’ users.id (1:1)</div>
    <div class="f uk"><span class="fb buk">UK</span>store_slug VARCHAR</div>
    <div class="f">store_name / store_email / store_phone</div>
    <div class="f">store_description / tagline</div>
    <div class="f">address / city / state / country</div>
    <div class="f-sep"></div>
    <div class="f">logo_url / banner_url / favicon_url</div>
    <div class="f">primary_color / secondary_color</div>
    <div class="f-sep"></div>
    <div class="f">business_name VARCHAR(255)</div>
    <div class="f">business_type ENUM</div>
    <div class="f">tax_id / registration_number</div>
    <div class="f">business_license_url / expiry</div>
    <div class="f-sep"></div>
    <div class="f">commission_rate DECIMAL(5,2)</div>
    <div class="f">status ENUM / verified BOOLEAN</div>
    <div class="f">verified_at TIMESTAMP</div>
    <div class="f-sep"></div>
    <div class="f">total_products / total_orders INT</div>
    <div class="f">total_sales / average_rating</div>
    <div class="f">website / social media URLs</div>
  </div>
</div>

<div class="e s5" id="vendor_bank_accounts" style="left:35px;top:1255px;animation-delay:.73s">
  <div class="eh"><div class="edot" style="background:var(--s5)"></div><span class="eico">ğŸ¦</span>vendor_bank_accounts<button class="copy-sql" onclick="copySql(event,'vendor_bank_accounts')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>vendor_id â†’ vendors.id</div>
    <div class="f">account_holder_name VARCHAR</div>
    <div class="f">bank_name VARCHAR(200)</div>
    <div class="f">account_number VARCHAR (encrypted)</div>
    <div class="f">routing_number VARCHAR (encrypted)</div>
    <div class="f">account_type ENUM (checking/savings)</div>
    <div class="f">swift_code / iban VARCHAR</div>
    <div class="f">is_verified / is_default BOOLEAN</div>
    <div class="f">verified_at TIMESTAMP</div>
  </div>
</div>

<div class="e s5" id="vendor_payouts" style="left:35px;top:1530px;animation-delay:.75s">
  <div class="eh"><div class="edot" style="background:var(--s5)"></div><span class="eico">ğŸ’°</span>vendor_payouts<button class="copy-sql" onclick="copySql(event,'vendor_payouts')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>vendor_id</div>
    <div class="f fk"><span class="fb bfk">FK</span>bank_account_id</div>
    <div class="f uk"><span class="fb buk">UK</span>payout_reference VARCHAR</div>
    <div class="f">gross_amount / commission_amount</div>
    <div class="f">gateway_fee / adjustments</div>
    <div class="f">net_amount DECIMAL(15,2)</div>
    <div class="f">period_from / period_to DATE</div>
    <div class="f">status / payment_method ENUM</div>
    <div class="f">transaction_id / notes</div>
    <div class="f">requested_at / processed_at / completed_at</div>
  </div>
</div>

<!-- S6: SHIPPING -->
<div class="slbl" style="left:2295px;top:30px;color:var(--s6)">06 Â· Shipping &amp; Fulfillment</div>

<div class="e s6" id="shipping_zones" style="left:2305px;top:65px;animation-delay:.77s">
  <div class="eh"><div class="edot" style="background:var(--s6)"></div><span class="eico">ğŸŒ</span>shipping_zones<button class="copy-sql" onclick="copySql(event,'shipping_zones')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>vendor_id (NULL = platform-wide)</div>
    <div class="f">name VARCHAR(150)</div>
    <div class="f">countries JSON (array of ISO codes)</div>
    <div class="f">is_active BOOLEAN</div>
  </div>
</div>

<div class="e s6" id="shipping_methods" style="left:2305px;top:260px;animation-delay:.79s">
  <div class="eh"><div class="edot" style="background:var(--s6)"></div><span class="eico">ğŸšš</span>shipping_methods<button class="copy-sql" onclick="copySql(event,'shipping_methods')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>shipping_zone_id</div>
    <div class="f">name / description</div>
    <div class="f">rate_type ENUM (flat/weight/price/free)</div>
    <div class="f">flat_rate / rate_per_kg DECIMAL</div>
    <div class="f">rate_percentage / free_threshold</div>
    <div class="f">min_delivery_days / max_delivery_days</div>
    <div class="f">is_active / display_order</div>
  </div>
</div>

<div class="e s6" id="shipments" style="left:2305px;top:520px;animation-delay:.81s">
  <div class="eh"><div class="edot" style="background:var(--s6)"></div><span class="eico">ğŸ“¬</span>shipments<button class="copy-sql" onclick="copySql(event,'shipments')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>order_id â†’ orders.id</div>
    <div class="f uk"><span class="fb buk">UK</span>shipment_number VARCHAR(50)</div>
    <div class="f">carrier / tracking_number</div>
    <div class="f">tracking_url VARCHAR(500)</div>
    <div class="f">shipping_method VARCHAR</div>
    <div class="f">status ENUM (8 states)</div>
    <div class="f">weight / dimensions DECIMAL</div>
    <div class="f">shipping_cost DECIMAL</div>
    <div class="f">shipped_at / estimated_delivery</div>
    <div class="f">delivered_at TIMESTAMP</div>
  </div>
</div>

<div class="e s6" id="shipment_items" style="left:2305px;top:810px;animation-delay:.83s">
  <div class="eh"><div class="edot" style="background:var(--s6)"></div><span class="eico">ğŸ“¦</span>shipment_items<button class="copy-sql" onclick="copySql(event,'shipment_items')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>shipment_id â†’ shipments.id</div>
    <div class="f fk"><span class="fb bfk">FK</span>order_item_id â†’ order_items.id</div>
    <div class="f">quantity INT UNSIGNED</div>
  </div>
</div>

<div class="e s6" id="shipment_tracking_events" style="left:2305px;top:980px;animation-delay:.85s">
  <div class="eh"><div class="edot" style="background:var(--s6)"></div><span class="eico">ğŸ“¡</span>tracking_events<button class="copy-sql" onclick="copySql(event,'shipment_tracking_events')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>shipment_id</div>
    <div class="f">status VARCHAR(100)</div>
    <div class="f">description TEXT</div>
    <div class="f">location VARCHAR(255)</div>
    <div class="f">event_time TIMESTAMP</div>
  </div>
</div>

<!-- S7: REVIEWS -->
<div class="slbl" style="left:2605px;top:30px;color:var(--s7)">07 Â· Reviews &amp; Ratings</div>

<div class="e s7" id="reviews" style="left:2615px;top:65px;animation-delay:.87s">
  <div class="eh"><div class="edot" style="background:var(--s7)"></div><span class="eico">â­</span>reviews<button class="copy-sql" onclick="copySql(event,'reviews')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>product_id â†’ products.id</div>
    <div class="f fk"><span class="fb bfk">FK</span>user_id â†’ users.id</div>
    <div class="f fk"><span class="fb bfk">FK</span>order_id (verified purchase link)</div>
    <div class="f">rating TINYINT UNSIGNED (1â€“5)</div>
    <div class="f">title VARCHAR(255)</div>
    <div class="f">review_text TEXT NOT NULL</div>
    <div class="f">is_verified_purchase BOOLEAN</div>
    <div class="f">status ENUM (pending/approved/spam)</div>
    <div class="f">helpful_count / unhelpful_count INT</div>
    <div class="f">has_vendor_response BOOLEAN</div>
    <div class="f">reviewed_at / updated_at</div>
  </div>
</div>

<div class="e s7" id="review_images" style="left:2615px;top:395px;animation-delay:.89s">
  <div class="eh"><div class="edot" style="background:var(--s7)"></div><span class="eico">ğŸ–¼ï¸</span>review_images<button class="copy-sql" onclick="copySql(event,'review_images')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>review_id â†’ reviews.id</div>
    <div class="f">image_url / thumbnail_url</div>
    <div class="f">display_order INT</div>
  </div>
</div>

<div class="e s7" id="review_responses" style="left:2615px;top:555px;animation-delay:.91s">
  <div class="eh"><div class="edot" style="background:var(--s7)"></div><span class="eico">ğŸ’¬</span>review_responses<button class="copy-sql" onclick="copySql(event,'review_responses')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>review_id</div>
    <div class="f">response_text TEXT NOT NULL</div>
    <div class="f fk"><span class="fb bfk">FK</span>responder_id â†’ users.id (vendor)</div>
    <div class="f">created_at / updated_at</div>
  </div>
</div>

<div class="e s7" id="review_votes" style="left:2615px;top:730px;animation-delay:.93s">
  <div class="eh"><div class="edot" style="background:var(--s7)"></div><span class="eico">ğŸ‘</span>review_votes<button class="copy-sql" onclick="copySql(event,'review_votes')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>review_id</div>
    <div class="f fk"><span class="fb bfk">FK</span>user_id</div>
    <div class="f">vote ENUM (helpful/unhelpful)</div>
    <div class="f uk"><span class="fb buk">UK</span>UNIQUE(review_id, user_id)</div>
  </div>
</div>

<!-- S8: MARKETING -->
<div class="slbl" style="left:2615px;top:880px;color:var(--s8)">08 Â· Marketing &amp; Promotions</div>

<div class="e s8" id="coupons" style="left:2615px;top:920px;animation-delay:.95s">
  <div class="eh"><div class="edot" style="background:var(--s8)"></div><span class="eico">ğŸŸï¸</span>coupons<button class="copy-sql" onclick="copySql(event,'coupons')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>vendor_id (NULL = platform-wide)</div>
    <div class="f uk"><span class="fb buk">UK</span>code VARCHAR(50)</div>
    <div class="f">name / description</div>
    <div class="f">discount_type ENUM (4 types)</div>
    <div class="f">discount_value / max_discount</div>
    <div class="f">min_order_amount DECIMAL</div>
    <div class="f">max_uses / uses_per_customer INT</div>
    <div class="f">times_used INT DEFAULT 0</div>
    <div class="f">applicable_to ENUM</div>
    <div class="f">customer_eligibility ENUM</div>
    <div class="f">valid_from / valid_until TIMESTAMP</div>
    <div class="f">is_active / show_on_store / auto_apply</div>
  </div>
</div>

<div class="e s8" id="coupon_products" style="left:2895px;top:920px;animation-delay:.97s">
  <div class="eh"><div class="edot" style="background:var(--s8)"></div><span class="eico">ğŸ”—</span>coupon_products<button class="copy-sql" onclick="copySql(event,'coupon_products')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>coupon_id</div>
    <div class="f fk"><span class="fb bfk">FK</span>product_id</div>
    <div class="f">is_excluded BOOLEAN</div>
  </div>
</div>

<div class="e s8" id="coupon_categories" style="left:2895px;top:1085px;animation-delay:.99s">
  <div class="eh"><div class="edot" style="background:var(--s8)"></div><span class="eico">ğŸ”—</span>coupon_categories<button class="copy-sql" onclick="copySql(event,'coupon_categories')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>coupon_id</div>
    <div class="f fk"><span class="fb bfk">FK</span>category_id</div>
    <div class="f">is_excluded BOOLEAN</div>
  </div>
</div>

<div class="e s8" id="coupon_usage" style="left:2615px;top:1220px;animation-delay:1.01s">
  <div class="eh"><div class="edot" style="background:var(--s8)"></div><span class="eico">ğŸ“Š</span>coupon_usage<button class="copy-sql" onclick="copySql(event,'coupon_usage')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>coupon_id â†’ coupons.id</div>
    <div class="f fk"><span class="fb bfk">FK</span>order_id â†’ orders.id</div>
    <div class="f fk"><span class="fb bfk">FK</span>user_id â†’ users.id</div>
    <div class="f">discount_amount DECIMAL</div>
    <div class="f">used_at TIMESTAMP</div>
  </div>
</div>

<div class="e s8" id="promotions" style="left:2615px;top:1430px;animation-delay:1.03s">
  <div class="eh"><div class="edot" style="background:var(--s8)"></div><span class="eico">ğŸ¯</span>promotions<button class="copy-sql" onclick="copySql(event,'promotions')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>vendor_id</div>
    <div class="f">name / slug / description</div>
    <div class="f">type ENUM (percentage/fixed/bogo/bundle/flash)</div>
    <div class="f">discount_value DECIMAL</div>
    <div class="f">buy_quantity / get_quantity INT</div>
    <div class="f">get_discount_percentage DECIMAL</div>
    <div class="f">banner_image_url / badge_text</div>
    <div class="f">show_countdown BOOLEAN</div>
    <div class="f">status ENUM</div>
    <div class="f">starts_at / ends_at TIMESTAMP</div>
    <div class="f">total_orders / total_revenue</div>
  </div>
</div>

<div class="e s8" id="promotion_products" style="left:2895px;top:1430px;animation-delay:1.05s">
  <div class="eh"><div class="edot" style="background:var(--s8)"></div><span class="eico">ğŸ”—</span>promotion_products<button class="copy-sql" onclick="copySql(event,'promotion_products')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>promotion_id â†’ promotions.id</div>
    <div class="f fk"><span class="fb bfk">FK</span>product_id â†’ products.id</div>
    <div class="f">custom_discount DECIMAL (override)</div>
    <div class="f uk"><span class="fb buk">UK</span>UNIQUE(promotion_id, product_id)</div>
  </div>
</div>

<!-- S9: CONTENT -->
<div class="slbl" style="left:30px;top:1760px;color:var(--s9)">09 Â· Content Management</div>

<div class="e s9" id="pages" style="left:35px;top:1800px;animation-delay:1.07s">
  <div class="eh"><div class="edot" style="background:var(--s9)"></div><span class="eico">ğŸ“„</span>pages<button class="copy-sql" onclick="copySql(event,'pages')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f uk"><span class="fb buk">UK</span>slug VARCHAR(255)</div>
    <div class="f">title VARCHAR(255)</div>
    <div class="f">content LONGTEXT</div>
    <div class="f">meta_title / meta_description</div>
    <div class="f">meta_keywords VARCHAR(500)</div>
    <div class="f">template VARCHAR DEFAULT 'default'</div>
    <div class="f">is_published / show_in_footer / header</div>
    <div class="f fk"><span class="fb bfk">FK</span>created_by â†’ users.id</div>
  </div>
</div>

<div class="e s9" id="banners" style="left:295px;top:1800px;animation-delay:1.09s">
  <div class="eh"><div class="edot" style="background:var(--s9)"></div><span class="eico">ğŸ–¼ï¸</span>banners<button class="copy-sql" onclick="copySql(event,'banners')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f">title VARCHAR(200)</div>
    <div class="f">image_url / mobile_image_url</div>
    <div class="f">link_url / link_text / open_in_new_tab</div>
    <div class="f">position ENUM (4 positions)</div>
    <div class="f">display_order / is_active</div>
    <div class="f">starts_at / ends_at TIMESTAMP</div>
    <div class="f">impression_count / click_count INT</div>
  </div>
</div>

<div class="e s9" id="blog_posts" style="left:555px;top:1800px;animation-delay:1.11s">
  <div class="eh"><div class="edot" style="background:var(--s9)"></div><span class="eico">âœï¸</span>blog_posts<button class="copy-sql" onclick="copySql(event,'blog_posts')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f uk"><span class="fb buk">UK</span>slug VARCHAR(255)</div>
    <div class="f fk"><span class="fb bfk">FK</span>author_id â†’ users.id</div>
    <div class="f">title / excerpt / content LONGTEXT</div>
    <div class="f">featured_image_url</div>
    <div class="f">category / tags JSON</div>
    <div class="f">meta_title / meta_description</div>
    <div class="f">status ENUM (draft/published/archived)</div>
    <div class="f">view_count / published_at</div>
    <div class="f">FULLTEXT INDEX on (title, content)</div>
  </div>
</div>

<!-- S10: SYSTEM/LOGS -->
<div class="slbl" style="left:825px;top:1760px;color:var(--s10)">10 Â· System &amp; Logs</div>

<div class="e s10" id="audit_logs" style="left:835px;top:1800px;animation-delay:1.13s">
  <div class="eh"><div class="edot" style="background:var(--s10)"></div><span class="eico">ğŸ“‹</span>audit_logs<button class="copy-sql" onclick="copySql(event,'audit_logs')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>user_id (SET NULL on delete)</div>
    <div class="f">user_email / user_type (snapshot)</div>
    <div class="f">action VARCHAR(100)</div>
    <div class="f">entity_type / entity_id BIGINT</div>
    <div class="f">description TEXT</div>
    <div class="f">old_values / new_values JSON</div>
    <div class="f">ip_address / user_agent / url</div>
    <div class="f">created_at TIMESTAMP</div>
  </div>
</div>

<div class="e s10" id="activity_logs" style="left:1085px;top:1800px;animation-delay:1.15s">
  <div class="eh"><div class="edot" style="background:var(--s10)"></div><span class="eico">ğŸ“Š</span>activity_logs<button class="copy-sql" onclick="copySql(event,'activity_logs')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>user_id â†’ users.id</div>
    <div class="f">activity_type VARCHAR(100)</div>
    <div class="f">description TEXT</div>
    <div class="f">properties JSON</div>
    <div class="f">ip_address / user_agent</div>
    <div class="f">created_at TIMESTAMP</div>
  </div>
</div>

<div class="e s10" id="notifications" style="left:1330px;top:1800px;animation-delay:1.17s">
  <div class="eh"><div class="edot" style="background:var(--s10)"></div><span class="eico">ğŸ””</span>notifications<button class="copy-sql" onclick="copySql(event,'notifications')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id CHAR(36) â€” UUID</div>
    <div class="f">type VARCHAR(255)</div>
    <div class="f">notifiable_type VARCHAR</div>
    <div class="f">notifiable_id BIGINT UNSIGNED</div>
    <div class="f">data JSON NOT NULL</div>
    <div class="f">read_at / created_at TIMESTAMP</div>
  </div>
</div>

<div class="e s10" id="email_logs" style="left:1560px;top:1800px;animation-delay:1.19s">
  <div class="eh"><div class="edot" style="background:var(--s10)"></div><span class="eico">ğŸ“§</span>email_logs<button class="copy-sql" onclick="copySql(event,'email_logs')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f">to_email / from_email VARCHAR</div>
    <div class="f">subject VARCHAR(500)</div>
    <div class="f">body LONGTEXT</div>
    <div class="f">email_type / related_type</div>
    <div class="f">related_id BIGINT</div>
    <div class="f">status ENUM (pending/sent/failed)</div>
    <div class="f">error_message TEXT</div>
    <div class="f">sent_at / opened_at / clicked_at</div>
  </div>
</div>

<div class="e s10" id="search_logs" style="left:1810px;top:1800px;animation-delay:1.21s">
  <div class="eh"><div class="edot" style="background:var(--s10)"></div><span class="eico">ğŸ”</span>search_logs<button class="copy-sql" onclick="copySql(event,'search_logs')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>user_id (SET NULL)</div>
    <div class="f">search_query VARCHAR(500)</div>
    <div class="f">results_count INT UNSIGNED</div>
    <div class="f">filters JSON</div>
    <div class="f">ip_address VARCHAR(45)</div>
    <div class="f">created_at TIMESTAMP</div>
  </div>
</div>

<div class="e s10" id="fraud_checks" style="left:2060px;top:1800px;animation-delay:1.23s">
  <div class="eh"><div class="edot" style="background:var(--s10)"></div><span class="eico">ğŸ›¡ï¸</span>fraud_checks<button class="copy-sql" onclick="copySql(event,'fraud_checks')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f fk"><span class="fb bfk">FK</span>order_id â†’ orders.id</div>
    <div class="f">risk_score INT UNSIGNED (0â€“100)</div>
    <div class="f">risk_level ENUM (low/medium/high/critical)</div>
    <div class="f">checks_performed JSON</div>
    <div class="f">flags JSON</div>
    <div class="f">decision ENUM (approve/review/reject)</div>
    <div class="f fk"><span class="fb bfk">FK</span>reviewed_by â†’ users.id</div>
    <div class="f">reviewed_at / review_notes</div>
  </div>
</div>

<div class="e s10" id="ip_blocks" style="left:2310px;top:1800px;animation-delay:1.25s">
  <div class="eh"><div class="edot" style="background:var(--s10)"></div><span class="eico">ğŸš«</span>ip_blocks<button class="copy-sql" onclick="copySql(event,'ip_blocks')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f uk"><span class="fb buk">UK</span>ip_address VARCHAR(45)</div>
    <div class="f">reason TEXT</div>
    <div class="f">block_type ENUM (manual/automatic/fraud)</div>
    <div class="f">is_active BOOLEAN</div>
    <div class="f">expires_at TIMESTAMP</div>
    <div class="f fk"><span class="fb bfk">FK</span>blocked_by â†’ users.id</div>
  </div>
</div>

<div class="e s10" id="settings" style="left:2560px;top:1800px;animation-delay:1.27s">
  <div class="eh"><div class="edot" style="background:var(--s10)"></div><span class="eico">âš™ï¸</span>settings<button class="copy-sql" onclick="copySql(event,'settings')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT</div>
    <div class="f uk"><span class="fb buk">UK</span>key VARCHAR(255)</div>
    <div class="f">value LONGTEXT</div>
    <div class="f">type ENUM (string/integer/boolean/json)</div>
    <div class="f">group VARCHAR(100) DEFAULT 'general'</div>
    <div class="f">description TEXT</div>
  </div>
</div>

<div class="e s10" id="failed_jobs" style="left:2805px;top:1800px;animation-delay:1.29s">
  <div class="eh"><div class="edot" style="background:var(--s10)"></div><span class="eico">âŒ</span>failed_jobs<button class="copy-sql" onclick="copySql(event,'failed_jobs')">â˜ SQL</button></div>
  <div class="ef">
    <div class="f pk"><span class="fb bpk">PK</span>id BIGINT UNSIGNED</div>
    <div class="f uk"><span class="fb buk">UK</span>uuid VARCHAR(255)</div>
    <div class="f">connection TEXT</div>
    <div class="f">queue TEXT</div>
    <div class="f">payload LONGTEXT</div>
    <div class="f">exception LONGTEXT</div>
    <div class="f">failed_at TIMESTAMP</div>
  </div>
</div>

    </div><!-- /canvas -->
  </div><!-- /cWrap -->

  <!-- â•â• SIDE PANEL â•â• -->
  <div class="side-panel" id="sidePanel">
    <div class="sp-header">
      <div class="sp-title" id="spTitle">ğŸ“‹ Table Details</div>
      <button class="sp-close" onclick="closePanel()">âœ•</button>
    </div>
    <div class="sp-body" id="spBody">
      <p style="color:var(--muted);font-size:.7rem;text-align:center;margin-top:2rem;">Click any table card to see details</p>
    </div>
  </div>
</div><!-- /main-body -->
</div><!-- /shell -->

<!-- Mini-Map -->
<div class="minimap" id="minimap">
  <canvas class="minimap-canvas" id="mmCanvas"></canvas>
  <div class="minimap-viewport" id="mmViewport"></div>
  <div class="minimap-label">Overview</div>
</div>

<!-- Zoom Controls -->
<div class="zoom-ctrl">
  <button class="zcb" id="zIn">+</button>
  <div class="zoom-val" id="zVal">50%</div>
  <button class="zcb" id="zOut">âˆ’</button>
  <button class="zcb" id="zReset">âŒ‚</button>
</div>

<!-- Tooltip -->
<div class="tip" id="tip"></div>

<!-- Footer -->
<div class="footer">
  <div class="f-left">
    <div class="f-av">DD</div>
    <div>
      <div class="f-name">Designed by <span>Mahabubur Rahman (DD)</span></div>
      <div class="f-role">Junior Software Engineer</div>
    </div>
  </div>
  <div class="f-right">
    <div class="ftag">â¬¡ E-Commerce ERD</div>
    <div class="ftag">65 Tables Â· 10 Domains</div>
    <div class="ftag">MySQL 8.0+ Â· InnoDB Â· utf8mb4</div>
    <div class="ftag" id="focusInfo" style="color:var(--s3);display:none">ğŸ¯ <span id="focusName">-</span> focused</div>
  </div>
</div>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DATA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const SECTIONS = {
  s1:'User & Auth', s2:'Products', s3:'Orders', s4:'Inventory',
  s5:'Vendors', s6:'Shipping', s7:'Reviews', s8:'Marketing',
  s9:'Content', s10:'System'
};
const SECTION_COLORS = {
  s1:'#22d3ee',s2:'#818cf8',s3:'#34d399',s4:'#f97316',s5:'#f472b6',
  s6:'#fbbf24',s7:'#fb7185',s8:'#2dd4bf',s9:'#a78bfa',s10:'#64748b'
};

const RELS = [
  {f:'users',t:'user_roles',c:'#22d3ee',l:'1:N'},{f:'user_roles',t:'roles',c:'#22d3ee',l:'N:1'},
  {f:'roles',t:'role_permissions',c:'#22d3ee',l:'1:N'},{f:'role_permissions',t:'permissions',c:'#22d3ee',l:'N:1'},
  {f:'users',t:'user_addresses',c:'#22d3ee',l:'1:N'},{f:'users',t:'user_sessions',c:'#22d3ee',l:'1:N'},
  {f:'categories',t:'category_attributes',c:'#818cf8',l:'1:N'},{f:'category_attributes',t:'attributes',c:'#818cf8',l:'N:1'},
  {f:'attributes',t:'attribute_values',c:'#818cf8',l:'1:N'},{f:'categories',t:'products',c:'#818cf8',l:'1:N'},
  {f:'products',t:'product_images',c:'#818cf8',l:'1:N'},{f:'products',t:'product_variants',c:'#818cf8',l:'1:N'},
  {f:'product_variants',t:'product_variant_attributes',c:'#818cf8',l:'1:N'},
  {f:'products',t:'product_attributes',c:'#818cf8',l:'1:N'},
  {f:'orders',t:'order_items',c:'#34d399',l:'1:N'},{f:'orders',t:'order_status_history',c:'#34d399',l:'1:N'},
  {f:'orders',t:'order_notes',c:'#34d399',l:'1:N'},{f:'orders',t:'refunds',c:'#34d399',l:'1:N'},
  {f:'refunds',t:'refund_items',c:'#34d399',l:'1:N'},{f:'orders',t:'transactions_t',c:'#34d399',l:'1:N'},
  {f:'order_addresses',t:'orders',c:'#34d399',l:'1:N'},
  {f:'products',t:'inventory_logs',c:'#f97316',l:'1:N'},{f:'products',t:'stock_alerts',c:'#f97316',l:'1:N'},
  {f:'warehouses',t:'warehouse_inventory',c:'#f97316',l:'1:N'},{f:'warehouses',t:'stock_transfers',c:'#f97316',l:'1:N'},
  {f:'users',t:'vendors',c:'#f472b6',l:'1:1'},{f:'vendors',t:'vendor_bank_accounts',c:'#f472b6',l:'1:N'},
  {f:'vendors',t:'vendor_payouts',c:'#f472b6',l:'1:N'},
  {f:'shipping_zones',t:'shipping_methods',c:'#fbbf24',l:'1:N'},{f:'orders',t:'shipments',c:'#fbbf24',l:'1:N'},
  {f:'shipments',t:'shipment_items',c:'#fbbf24',l:'1:N'},{f:'shipments',t:'shipment_tracking_events',c:'#fbbf24',l:'1:N'},
  {f:'products',t:'reviews',c:'#fb7185',l:'1:N'},{f:'reviews',t:'review_images',c:'#fb7185',l:'1:N'},
  {f:'reviews',t:'review_responses',c:'#fb7185',l:'1:N'},{f:'reviews',t:'review_votes',c:'#fb7185',l:'1:N'},
  {f:'coupons',t:'coupon_products',c:'#2dd4bf',l:'1:N'},{f:'coupons',t:'coupon_categories',c:'#2dd4bf',l:'1:N'},
  {f:'coupons',t:'coupon_usage',c:'#2dd4bf',l:'1:N'},{f:'promotions',t:'promotion_products',c:'#2dd4bf',l:'1:N'},
];

// SQL templates per table
const SQL_TEMPLATES = {
  users:`CREATE TABLE users (\n  id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n  email VARCHAR(255) NOT NULL UNIQUE,\n  password VARCHAR(255) NOT NULL,\n  first_name VARCHAR(100) NOT NULL,\n  last_name VARCHAR(100) NOT NULL,\n  phone VARCHAR(20) NULL,\n  user_type ENUM('customer','vendor','admin') NOT NULL DEFAULT 'customer',\n  status ENUM('active','inactive','suspended','banned') NOT NULL DEFAULT 'active',\n  two_factor_enabled BOOLEAN DEFAULT FALSE,\n  last_login_at TIMESTAMP NULL,\n  preferred_currency VARCHAR(3) DEFAULT 'USD',\n  timezone VARCHAR(50) DEFAULT 'UTC',\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  deleted_at TIMESTAMP NULL\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;`,
  products:`CREATE TABLE products (\n  id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n  vendor_id BIGINT UNSIGNED NOT NULL,\n  category_id BIGINT UNSIGNED NOT NULL,\n  name VARCHAR(255) NOT NULL,\n  slug VARCHAR(255) NOT NULL,\n  sku VARCHAR(100) NOT NULL UNIQUE,\n  price DECIMAL(10,2) NOT NULL,\n  sale_price DECIMAL(10,2) NULL,\n  stock_quantity INT DEFAULT 0,\n  low_stock_threshold INT DEFAULT 10,\n  type ENUM('simple','variable','digital') NOT NULL DEFAULT 'simple',\n  status ENUM('draft','pending','approved','published','rejected') NOT NULL DEFAULT 'draft',\n  is_featured BOOLEAN DEFAULT FALSE,\n  rating_average DECIMAL(3,2) DEFAULT 0.00,\n  rating_count INT UNSIGNED DEFAULT 0,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  deleted_at TIMESTAMP NULL,\n  FOREIGN KEY (vendor_id) REFERENCES vendors(id) ON DELETE CASCADE,\n  FOREIGN KEY (category_id) REFERENCES categories(id)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;`,
  orders:`CREATE TABLE orders (\n  id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n  order_number VARCHAR(50) NOT NULL UNIQUE,\n  user_id BIGINT UNSIGNED NULL,\n  guest_email VARCHAR(255) NULL,\n  subtotal DECIMAL(15,2) NOT NULL,\n  discount_amount DECIMAL(15,2) DEFAULT 0.00,\n  shipping_amount DECIMAL(15,2) DEFAULT 0.00,\n  tax_amount DECIMAL(15,2) DEFAULT 0.00,\n  total_amount DECIMAL(15,2) NOT NULL,\n  currency VARCHAR(3) DEFAULT 'USD',\n  status ENUM('pending','processing','on_hold','shipped','delivered','cancelled','refunded','failed') NOT NULL DEFAULT 'pending',\n  payment_status ENUM('pending','paid','failed','refunded','partially_refunded') NOT NULL DEFAULT 'pending',\n  payment_method VARCHAR(50) NULL,\n  paid_at TIMESTAMP NULL,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;`,
};

function getSql(tableName) {
  return SQL_TEMPLATES[tableName] ||
    `-- CREATE TABLE ${tableName}\n-- (Full SQL available in schema documentation)\n\nCREATE TABLE ${tableName} (\n  id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n  -- ... columns ...\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;`;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BG PARTICLES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const bgC=document.getElementById('bgCanvas');
const bgX=bgC.getContext('2d');
let bW,bH,bPts=[];
function initBg(){
  bW=bgC.width=window.innerWidth; bH=bgC.height=window.innerHeight; bPts=[];
  const n=Math.floor(bW*bH/22000);
  for(let i=0;i<n;i++) bPts.push({x:Math.random()*bW,y:Math.random()*bH,vx:(Math.random()-.5)*.25,vy:(Math.random()-.5)*.25,r:Math.random()*.9+.3});
}
function drawBg(){
  bgX.clearRect(0,0,bW,bH);
  const isDark=document.documentElement.getAttribute('data-theme')==='dark';
  const lineA=isDark?.065:.04; const dotA=isDark?.45:.25;
  for(let i=0;i<bPts.length;i++){
    for(let j=i+1;j<bPts.length;j++){
      const dx=bPts[i].x-bPts[j].x,dy=bPts[i].y-bPts[j].y,d=Math.sqrt(dx*dx+dy*dy);
      if(d<100){bgX.beginPath();bgX.strokeStyle=`rgba(34,211,238,${lineA*(1-d/100)})`;bgX.lineWidth=.5;bgX.moveTo(bPts[i].x,bPts[i].y);bgX.lineTo(bPts[j].x,bPts[j].y);bgX.stroke();}
    }
  }
  bPts.forEach(p=>{
    bgX.beginPath();bgX.arc(p.x,p.y,p.r,0,Math.PI*2);bgX.fillStyle=`rgba(34,211,238,${dotA})`;bgX.fill();
    p.x+=p.vx;p.y+=p.vy;
    if(p.x<0||p.x>bW)p.vx*=-1;if(p.y<0||p.y>bH)p.vy*=-1;
  });
  requestAnimationFrame(drawBg);
}
initBg();drawBg();
window.addEventListener('resize',initBg);

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SVG LINES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let dashOff=0;
function getBox(id){
  const el=document.getElementById(id);
  if(!el)return null;
  return{x:parseFloat(el.style.left)||0,y:parseFloat(el.style.top)||0,w:el.offsetWidth,h:el.offsetHeight};
}
function getEdge(b,tx,ty){
  const cx=b.x+b.w/2,cy=b.y+b.h/2,dx=tx-cx,dy=ty-cy,hw=b.w/2,hh=b.h/2;
  const sl=dy/dx;let ex,ey;
  if(Math.abs(sl)<hh/hw){ex=cx+(dx>0?hw:-hw);ey=cy+sl*(dx>0?hw:-hw);}
  else{ey=cy+(dy>0?hh:-hh);ex=cx+(dy>0?hh:-hh)/sl;}
  return{x:ex,y:ey};
}
function drawLines(){
  const svg=document.getElementById('svgLines');
  svg.innerHTML='';
  const defs=document.createElementNS('http://www.w3.org/2000/svg','defs');
  const blurF=document.createElementNS('http://www.w3.org/2000/svg','filter');
  blurF.setAttribute('id','gblur');
  const fgb=document.createElementNS('http://www.w3.org/2000/svg','feGaussianBlur');
  fgb.setAttribute('stdDeviation','3');blurF.appendChild(fgb);defs.appendChild(blurF);
  [...new Set(RELS.map(r=>r.c))].forEach(col=>{
    const mk=document.createElementNS('http://www.w3.org/2000/svg','marker');
    mk.setAttribute('id','mk'+col.replace('#',''));mk.setAttribute('markerWidth','7');mk.setAttribute('markerHeight','7');
    mk.setAttribute('refX','6');mk.setAttribute('refY','3.5');mk.setAttribute('orient','auto');
    const poly=document.createElementNS('http://www.w3.org/2000/svg','polygon');
    poly.setAttribute('points','0 0,7 3.5,0 7');poly.setAttribute('fill',col);poly.setAttribute('opacity','.85');
    mk.appendChild(poly);defs.appendChild(mk);
  });
  svg.appendChild(defs);

  RELS.forEach(rel=>{
    const fb=getBox(rel.f),tb=getBox(rel.t);
    if(!fb||!tb)return;
    const fp=getEdge(fb,tb.x+tb.w/2,tb.y+tb.h/2);
    const tp=getEdge(tb,fb.x+fb.w/2,fb.y+fb.h/2);
    const dx=tp.x-fp.x,bend=Math.min(Math.abs(dx),100)*.55;
    const c1x=fp.x+bend*Math.sign(dx),c1y=fp.y,c2x=tp.x-bend*Math.sign(dx),c2y=tp.y;
    const d=`M${fp.x} ${fp.y} C${c1x} ${c1y} ${c2x} ${c2y} ${tp.x} ${tp.y}`;
    // glow
    const g=document.createElementNS('http://www.w3.org/2000/svg','path');
    g.setAttribute('d',d);g.setAttribute('stroke',rel.c);g.setAttribute('stroke-width','5');
    g.setAttribute('fill','none');g.setAttribute('opacity','.06');g.setAttribute('filter','url(#gblur)');
    svg.appendChild(g);
    // main
    const p=document.createElementNS('http://www.w3.org/2000/svg','path');
    p.setAttribute('d',d);p.setAttribute('stroke',rel.c);p.setAttribute('stroke-width','1.6');
    p.setAttribute('fill','none');p.setAttribute('opacity','.38');
    p.setAttribute('stroke-dasharray','6 4');p.setAttribute('stroke-dashoffset',dashOff);
    p.setAttribute('marker-end',`url(#mk${rel.c.replace('#','')})`);
    p.setAttribute('data-from',rel.f);p.setAttribute('data-to',rel.t);
    p.style.transition='opacity .2s,stroke-width .2s';
    p.addEventListener('mouseenter',e=>{
      p.setAttribute('opacity','1');p.setAttribute('stroke-width','2.8');
      const tip=document.getElementById('tip');
      tip.style.display='block';tip.textContent=`${rel.f} â†’ ${rel.t}  (${rel.l})`;
      tip.style.left=(e.clientX+12)+'px';tip.style.top=(e.clientY-26)+'px';
    });
    p.addEventListener('mousemove',e=>{const tip=document.getElementById('tip');tip.style.left=(e.clientX+12)+'px';tip.style.top=(e.clientY-26)+'px';});
    p.addEventListener('mouseleave',()=>{p.setAttribute('opacity','.38');p.setAttribute('stroke-width','1.6');document.getElementById('tip').style.display='none';});
    p.style.pointerEvents='stroke';p.style.cursor='pointer';
    svg.appendChild(p);
    // label
    const mx=(fp.x+tp.x)/2,my=(fp.y+tp.y)/2-7;
    const txt=document.createElementNS('http://www.w3.org/2000/svg','text');
    txt.setAttribute('x',mx);txt.setAttribute('y',my);txt.setAttribute('text-anchor','middle');
    txt.setAttribute('font-size','8.5');txt.setAttribute('font-family','Fira Code,monospace');
    txt.setAttribute('fill',rel.c);txt.setAttribute('opacity','.55');txt.textContent=rel.l;
    svg.appendChild(txt);
  });
}
function animLines(){
  dashOff-=.4;
  document.querySelectorAll('#svgLines path[stroke-dasharray]').forEach(p=>p.setAttribute('stroke-dashoffset',dashOff));
  requestAnimationFrame(animLines);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SEARCH
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
document.getElementById('searchIn').addEventListener('input',function(){
  const q=this.value.trim().toLowerCase();
  if(!q){document.querySelectorAll('.e').forEach(e=>{e.classList.remove('dimmed');e.classList.remove('focused');});return;}
  document.querySelectorAll('.e').forEach(el=>{
    const id=el.id.toLowerCase(),name=el.querySelector('.eh')?.textContent?.toLowerCase()||'';
    (id.includes(q)||name.includes(q))?el.classList.remove('dimmed'):el.classList.add('dimmed');
  });
});

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SECTION TOGGLE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const hiddenSections=new Set();
function toggleSection(sec,el){
  if(hiddenSections.has(sec)){
    hiddenSections.delete(sec);
    document.querySelectorAll('.e.'+sec).forEach(e=>e.classList.remove('section-hidden'));
    el.classList.remove('hidden');
  }else{
    hiddenSections.add(sec);
    document.querySelectorAll('.e.'+sec).forEach(e=>e.classList.add('section-hidden'));
    el.classList.add('hidden');
  }
  setTimeout(()=>{drawLines();},100);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CLICK-TO-FOCUS + SIDE PANEL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let focusedId=null;
document.querySelectorAll('.e').forEach(el=>{
  el.addEventListener('click',function(e){
    if(e.target.classList.contains('copy-sql'))return;
    const id=this.id;
    if(focusedId===id){clearFocus();return;}
    focusedId=id;
    // dim all, focus connected
    const connected=new Set([id]);
    RELS.forEach(r=>{if(r.f===id)connected.add(r.t);if(r.t===id)connected.add(r.f);});
    document.querySelectorAll('.e').forEach(e=>{
      e.classList.toggle('dimmed',!connected.has(e.id));
      e.classList.toggle('focused',e.id===id);
    });
    // highlight relevant lines
    document.querySelectorAll('#svgLines path[data-from]').forEach(p=>{
      const f=p.getAttribute('data-from'),t=p.getAttribute('data-to');
      p.setAttribute('opacity',(f===id||t===id)?'1':'.06');
      p.setAttribute('stroke-width',(f===id||t===id)?'2.5':'1');
    });
    document.getElementById('btnEsc').style.display='flex';
    document.getElementById('focusInfo').style.display='flex';
    document.getElementById('focusName').textContent=id;
    openPanel(id,connected);
  });
});

function clearFocus(){
  focusedId=null;
  document.querySelectorAll('.e').forEach(e=>{e.classList.remove('dimmed','focused');});
  document.querySelectorAll('#svgLines path[data-from]').forEach(p=>{p.setAttribute('opacity','.38');p.setAttribute('stroke-width','1.6');});
  document.getElementById('btnEsc').style.display='none';
  document.getElementById('focusInfo').style.display='none';
  closePanel();
}
document.getElementById('btnEsc').addEventListener('click',clearFocus);
document.addEventListener('keydown',e=>{if(e.key==='Escape')clearFocus();});

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SIDE PANEL CONTENT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function openPanel(tableId,connected){
  const panel=document.getElementById('sidePanel');
  panel.classList.add('open');
  const el=document.getElementById(tableId);
  if(!el)return;
  const sec=[...el.classList].find(c=>c.match(/^s\d+$/));
  const secName=SECTIONS[sec]||'';
  const secColor=SECTION_COLORS[sec]||'#64748b';
  const headerText=el.querySelector('.eh')?.textContent?.replace('â˜ SQL','').trim()||tableId;
  document.getElementById('spTitle').innerHTML=`<span style="color:${secColor}">${headerText}</span>`;

  // Build columns list from .f elements
  const fields=el.querySelectorAll('.ef .f');
  const rels_in=RELS.filter(r=>r.t===tableId);
  const rels_out=RELS.filter(r=>r.f===tableId);

  let html=`<div class="sp-section"><h3>ğŸ“Œ Domain</h3>
    <div class="sp-col"><span class="col-name">${secName}</span><span class="col-badge" style="background:${secColor}22;color:${secColor}">Section ${sec?.toUpperCase()}</span></div>
  </div>`;

  html+=`<div class="sp-section"><h3>ğŸ“‹ Columns (${fields.length})</h3>`;
  fields.forEach(f=>{
    if(f.classList.contains('f-sep'))return;
    const badge=f.querySelector('.fb');
    const badgeHtml=badge?`<span class="col-badge ${badge.className.split(' ').find(c=>c.startsWith('b'))||''}" style="font-size:.44rem;padding:.06rem .26rem;border-radius:3px;font-weight:700;font-family:var(--mono)">${badge.textContent}</span>`:'';
    const text=f.textContent.replace(badge?.textContent||'','').trim();
    html+=`<div class="sp-col">${badgeHtml}<span class="col-name" style="flex:1">${text}</span></div>`;
  });
  html+=`</div>`;

  if(rels_out.length>0){
    html+=`<div class="sp-section"><h3>â†’ References (${rels_out.length})</h3>`;
    rels_out.forEach(r=>{
      html+=`<div class="sp-rel" onclick="document.getElementById('${r.t}')?.scrollIntoView({block:'center'})">
        <span style="color:var(--s3)">â†’</span>
        <span style="color:var(--text)">${r.t}</span>
        <span class="rel-arrow">(${r.l})</span>
      </div>`;
    });
    html+=`</div>`;
  }

  if(rels_in.length>0){
    html+=`<div class="sp-section"><h3>â† Referenced by (${rels_in.length})</h3>`;
    rels_in.forEach(r=>{
      html+=`<div class="sp-rel" onclick="document.getElementById('${r.f}')?.scrollIntoView({block:'center'})">
        <span style="color:var(--s5)">â†</span>
        <span style="color:var(--text)">${r.f}</span>
        <span class="rel-arrow">(${r.l})</span>
      </div>`;
    });
    html+=`</div>`;
  }

  html+=`<div class="sp-section"><h3>ğŸ“‹ SQL Statement</h3>
    <button class="sp-sql-btn" id="spSqlBtn" onclick="copyFullSql('${tableId}',this)">â˜ Copy CREATE TABLE SQL</button>
  </div>`;

  document.getElementById('spBody').innerHTML=html;
}

function closePanel(){
  document.getElementById('sidePanel').classList.remove('open');
}

function copyFullSql(tableName,btn){
  const sql=getSql(tableName);
  navigator.clipboard.writeText(sql).then(()=>{
    btn.classList.add('copied');btn.textContent='âœ“ Copied!';
    setTimeout(()=>{btn.classList.remove('copied');btn.textContent='â˜ Copy CREATE TABLE SQL';},2000);
  });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SQL COPY BUTTON (per card)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function copySql(e,tableName){
  e.stopPropagation();
  const btn=e.target;
  const sql=getSql(tableName);
  navigator.clipboard.writeText(sql).then(()=>{
    btn.classList.add('copied');btn.textContent='âœ“ Copied';
    setTimeout(()=>{btn.classList.remove('copied');btn.textContent='â˜ SQL';},2000);
  }).catch(()=>{
    btn.textContent='â˜ SQL';
  });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LIGHT/DARK TOGGLE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
document.getElementById('btnTheme').addEventListener('click',function(){
  const curr=document.documentElement.getAttribute('data-theme');
  document.documentElement.setAttribute('data-theme',curr==='dark'?'light':'dark');
  this.textContent=curr==='dark'?'â˜€ï¸ Light':'ğŸŒ— Dark';
});

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MINI-MAP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const mmCanvas=document.getElementById('mmCanvas');
const mmCtx=mmCanvas.getContext('2d');
const CMAP_W=3400,CMAP_H=2620;
let mmVisible=true;

function drawMinimap(){
  const mm=document.getElementById('minimap');
  const mw=mm.clientWidth,mh=mm.clientHeight;
  mmCanvas.width=mw;mmCanvas.height=mh;
  const scX=mw/CMAP_W,scY=mh/CMAP_H;
  const isDark=document.documentElement.getAttribute('data-theme')==='dark';
  mmCtx.fillStyle=isDark?'#060b14':'#f0f4f8';
  mmCtx.fillRect(0,0,mw,mh);
  // grid
  mmCtx.strokeStyle=isDark?'rgba(34,211,238,.04)':'rgba(34,211,238,.1)';
  mmCtx.lineWidth=.5;
  for(let x=0;x<mw;x+=60*scX){mmCtx.beginPath();mmCtx.moveTo(x,0);mmCtx.lineTo(x,mh);mmCtx.stroke();}
  for(let y=0;y<mh;y+=60*scY){mmCtx.beginPath();mmCtx.moveTo(0,y);mmCtx.lineTo(mw,y);mmCtx.stroke();}
  // entities
  document.querySelectorAll('.e').forEach(el=>{
    if(el.classList.contains('section-hidden'))return;
    const sec=[...el.classList].find(c=>c.match(/^s\d+$/));
    const col=SECTION_COLORS[sec]||'#64748b';
    const x=(parseFloat(el.style.left)||0)*scX;
    const y=(parseFloat(el.style.top)||0)*scY;
    const w=el.offsetWidth*scX;
    const h=el.offsetHeight*scY;
    mmCtx.fillStyle=col+'33';
    mmCtx.strokeStyle=col;
    mmCtx.lineWidth=.8;
    mmCtx.beginPath();
    mmCtx.roundRect(x,y,w,h,1);
    mmCtx.fill();mmCtx.stroke();
  });
  // viewport indicator
  const wrap=document.getElementById('cWrap');
  const vx=(wrap.scrollLeft/scale)*scX;
  const vy=(wrap.scrollTop/scale)*scY;
  const vw=(wrap.clientWidth/scale)*scX;
  const vh=(wrap.clientHeight/scale)*scY;
  const vp=document.getElementById('mmViewport');
  vp.style.left=(vx*mw/mw)+'px';vp.style.top=(vy*mh/mh)+'px';
  vp.style.width=Math.min(vw,mw-vx)+'px';vp.style.height=Math.min(vh,mh-vy)+'px';
}
setInterval(drawMinimap,500);

document.getElementById('btnMinimap').addEventListener('click',function(){
  mmVisible=!mmVisible;
  const minimap = document.getElementById('minimap');
  minimap.classList.toggle('hidden',!mmVisible);
  this.classList.toggle('active',mmVisible);
  
  // Update button text and add visual feedback
  this.innerHTML = mmVisible ? 'ğŸ—ºï¸ Hide Map' : 'ğŸ—ºï¸ Show Map';
  
  // Add scale animation
  if(mmVisible) {
    minimap.style.animation = 'minimapShow 0.4s cubic-bezier(.16,1,.3,1)';
  }
});

// Add minimap show animation
const style = document.createElement('style');
style.textContent = `
  @keyframes minimapShow {
    0% { opacity: 0; transform: translateY(30px) scale(0.8); }
    100% { opacity: 1; transform: translateY(0) scale(1); }
  }
  
  .hbtn#btnEsc {
    background: rgba(239,68,68,0.1) !important;
    border-color: rgba(239,68,68,0.4) !important;
    color: rgba(239,68,68,0.9) !important;
  }
  .hbtn#btnEsc:hover {
    background: rgba(239,68,68,0.2) !important;
    border-color: rgba(239,68,68,0.6) !important;
    transform: scale(1.05);
  }
`;
document.head.appendChild(style);

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PAN & ZOOM
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let scale=0.5,isDrag=false,sx,sy,sl,st;
const wrap=document.getElementById('cWrap');
const canvas=document.getElementById('canvas');

function setScale(s){
  scale=Math.min(1.8,Math.max(0.15,s));
  canvas.style.transform=`scale(${scale})`;
  document.getElementById('zVal').textContent=Math.round(scale*100)+'%';
}

wrap.addEventListener('mousedown',e=>{
  if(e.target.closest('.e')||e.target.closest('#svgLines path'))return;
  isDrag=true;sx=e.pageX-wrap.offsetLeft;sy=e.pageY-wrap.offsetTop;sl=wrap.scrollLeft;st=wrap.scrollTop;
});
document.addEventListener('mouseup',()=>isDrag=false);
document.addEventListener('mousemove',e=>{
  if(!isDrag)return;
  wrap.scrollLeft=sl-(e.pageX-wrap.offsetLeft-sx);
  wrap.scrollTop=st-(e.pageY-wrap.offsetTop-sy);
});
wrap.addEventListener('wheel',e=>{
  e.preventDefault();setScale(scale+(e.deltaY<0?.06:-.06));
},{passive:false});
document.getElementById('zIn').onclick=()=>setScale(scale+.1);
document.getElementById('zOut').onclick=()=>setScale(scale-.1);
document.getElementById('zReset').addEventListener('click',()=>{
  setScale(.5);wrap.scrollLeft=0;wrap.scrollTop=0;clearFocus();
  document.getElementById('searchIn').value='';
  document.querySelectorAll('.e').forEach(e=>e.classList.remove('dimmed','focused'));
});
document.getElementById('btnReset').addEventListener('click',()=>document.getElementById('zReset').click());

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INIT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
wrap.style.height=(window.innerHeight-90)+'px';
canvas.style.transformOrigin='0 0';
setScale(.5);
window.addEventListener('resize',()=>wrap.style.height=(window.innerHeight-90)+'px');
setTimeout(()=>{drawLines();animLines();drawMinimap();},350);
</script>
</body>
</html>